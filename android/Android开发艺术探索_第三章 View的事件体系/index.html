<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="进阶,Android开发艺术探索," />










<meta name="description" content="这个是非常重要的一个内容，一般面试的时候都会问一下的  View基础知识什么是View？View是android中所有控件的基类，用户的交互其实是可View直接交互的，可以把它理解为界面层的抽象，所有的View可以理解为屏幕中间的一块矩形区域ViewGroup是一个控件组。 View的位置？系统是通过坐标系来确认View的位置的，View主要有四个属性：top，left，right，bottom">
<meta name="keywords" content="进阶,Android开发艺术探索">
<meta property="og:type" content="article">
<meta property="og:title" content="Android开发艺术探索 第三章 View的事件体系">
<meta property="og:url" content="http://yoursite.com/android/Android开发艺术探索_第三章 View的事件体系/index.html">
<meta property="og:site_name" content="个人网站">
<meta property="og:description" content="这个是非常重要的一个内容，一般面试的时候都会问一下的  View基础知识什么是View？View是android中所有控件的基类，用户的交互其实是可View直接交互的，可以把它理解为界面层的抽象，所有的View可以理解为屏幕中间的一块矩形区域ViewGroup是一个控件组。 View的位置？系统是通过坐标系来确认View的位置的，View主要有四个属性：top，left，right，bottom">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://yoursite.com/android/Android开发艺术探索_第三章%20View的事件体系/图像1521983638.png">
<meta property="og:image" content="http://yoursite.com/android/Android开发艺术探索_第三章%20View的事件体系/图像1522504775.png">
<meta property="og:image" content="http://yoursite.com/android/Android开发艺术探索_第三章%20View的事件体系/device-2018-03-31-224723.png">
<meta property="og:image" content="http://yoursite.com/android/Android开发艺术探索_第三章%20View的事件体系/device-2018-03-31-224548.png">
<meta property="og:image" content="http://yoursite.com/android/Android开发艺术探索_第三章%20View的事件体系/device-2018-03-31-224548.png">
<meta property="og:image" content="http://yoursite.com/android/Android开发艺术探索_第三章%20View的事件体系/device-2018-03-31-224323.png">
<meta property="og:image" content="http://yoursite.com/android/Android开发艺术探索_第三章%20View的事件体系/device-2018-03-31-224323.png">
<meta property="og:image" content="http://yoursite.com/android/Android开发艺术探索_第三章%20View的事件体系/device-2018-03-31-232202.png">
<meta property="og:updated_time" content="2018-07-26T13:02:16.525Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Android开发艺术探索 第三章 View的事件体系">
<meta name="twitter:description" content="这个是非常重要的一个内容，一般面试的时候都会问一下的  View基础知识什么是View？View是android中所有控件的基类，用户的交互其实是可View直接交互的，可以把它理解为界面层的抽象，所有的View可以理解为屏幕中间的一块矩形区域ViewGroup是一个控件组。 View的位置？系统是通过坐标系来确认View的位置的，View主要有四个属性：top，left，right，bottom">
<meta name="twitter:image" content="http://yoursite.com/android/Android开发艺术探索_第三章%20View的事件体系/图像1521983638.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/android/Android开发艺术探索_第三章 View的事件体系/"/>





  <title>Android开发艺术探索 第三章 View的事件体系 | 个人网站</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">个人网站</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/android/Android开发艺术探索_第三章 View的事件体系/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Groot">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="个人网站">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Android开发艺术探索 第三章 View的事件体系</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-27T17:08:22+08:00">
                2018-01-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/android/" itemprop="url" rel="index">
                    <span itemprop="name">android</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>这个是非常重要的一个内容，一般面试的时候都会问一下的</p>
</blockquote>
<h1 id="View基础知识"><a href="#View基础知识" class="headerlink" title="View基础知识"></a>View基础知识</h1><h2 id="什么是View？"><a href="#什么是View？" class="headerlink" title="什么是View？"></a>什么是View？</h2><p>View是android中所有控件的基类，用户的交互其实是可View直接交互的，可以把它理解为界面层的抽象，所有的View可以理解为屏幕中间的一块矩形区域<br>ViewGroup是一个控件组。</p>
<h2 id="View的位置？"><a href="#View的位置？" class="headerlink" title="View的位置？"></a>View的位置？</h2><p>系统是通过坐标系来确认View的位置的，View主要有四个属性：top，left，right，bottom。</p>
<ul>
<li>top View最上面距离父控件顶的距离</li>
<li>left View最左面距离父控件左面的距离</li>
<li>right View最右面距离父控件左面的距离</li>
<li>bottom View最下面距离父控件顶的距离</li>
</ul>
<p>需要注意一下这里的坐标系，他是相对于父控件来讲的。<br>这里用图来说明一下</p>
<p><img src="图像1521983638.png" alt="Alt text" title="一个例子"></p>
<p>如何获取这四个值呢</p>
<ul>
<li>left=view.getLeft();</li>
<li>right=view.getRight();</li>
<li>Top=view.getTop();</li>
<li>Bottom=view.getBottom();</li>
</ul>
<p>控件的 width=right-left<br>控件的 height=bottom-top</p>
<p>这里要注意下：android 3.0 之后为view新加了4个属性，分别为x,y,translationX和translationY<br>其中x和y是View的左上角坐标，而translationX和translationY是View左上角相对于父容器的偏移量这几个值也是相对于父容器的坐标值。并且translationX和translationY的默认值是0。和View的四个基本位置参数一样，view也为他们提供了get和set方法，换算关系如下<br>x=left+translationX<br>y=top+translationY<br>需要注意的是，在View的平移过程中，top和left表示原始右上角的位置信息。其值不会发生改变，此时发生改变的是x，y，translationX和translationY</p>
<p>在5.0以后新加了x这个属性，这个是z轴的距离，用来显示阴影，想象一下桌子上面悬挂一个灯泡 然后会在桌子边缘有一个阴影。而x是桌子的高度 这样可以控制影子的大小。</p>
<p>这里补充一点，怎么样获取控件到屏幕的距离呢，而不是到父控件的距离,这里有两个方法</p>
<ul>
<li>getLocationOnScreen():用来获取一个View在屏幕中的位置</li>
<li>getLocationInWindow():用来获取一个View在其所在窗口中的位置</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int[] screenLocation = new int [2];</span><br><span class="line">int[] windowLocation = new int [2];</span><br><span class="line">getLocationInWindow();</span><br><span class="line">getLocationOnScreen(windowLocation)</span><br></pre></td></tr></table></figure>
<p>在activity中他们获取的值是一样的，如果不是在activity中，就不一样了，因为activity是一个全屏的windows，而dialog不是一个全屏的dialog,在toast中和dialog是一致的,这个后面会介绍的</p>
<p>下面写一个demo来验证一下x=left+translationX和y=top+translationY的换算关系</p>
<p>布局<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;FrameLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    xmlns:tools=&quot;http://schemas.android.com/tools&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    android:background=&quot;#00ffff&quot;</span><br><span class="line">    tools:context=&quot;com.smart.kaifa.MainActivity&quot;&gt;</span><br><span class="line">    &lt;FrameLayout</span><br><span class="line">        android:layout_width=&quot;200dp&quot;</span><br><span class="line">        android:layout_height=&quot;400dp&quot;</span><br><span class="line">        android:layout_marginLeft=&quot;100dp&quot;</span><br><span class="line">        android:background=&quot;#ffff00&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:background=&quot;#ff0000&quot;</span><br><span class="line">            android:id=&quot;@+id/test&quot;</span><br><span class="line">            android:layout_width=&quot;20dp&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;20dp&quot;</span><br><span class="line">            android:layout_marginTop=&quot;20dp&quot;</span><br><span class="line">            android:layout_height=&quot;20dp&quot; /&gt;</span><br><span class="line">    &lt;/FrameLayout&gt;</span><br><span class="line">&lt;/FrameLayout&gt;</span><br></pre></td></tr></table></figure></p>
<p>代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    private int left;</span><br><span class="line">    private int right;</span><br><span class="line">    private int bottom;</span><br><span class="line">    private int top;</span><br><span class="line">    private int width;</span><br><span class="line">    private int height;</span><br><span class="line">    private float x;</span><br><span class="line">    private float y;</span><br><span class="line">    private float translationX;</span><br><span class="line">    private float scrollX;</span><br><span class="line">    private float translationY;</span><br><span class="line">    private float scrollY;</span><br><span class="line">    private View viewById;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        viewById = findViewById(R.id.test);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    //activity 真正可见的时间点</span><br><span class="line">    @Override</span><br><span class="line">    public void onWindowFocusChanged(boolean hasFocus) &#123;</span><br><span class="line">        // TODO Auto-generated method stub</span><br><span class="line">        if(hasFocus)&#123;</span><br><span class="line">            left = viewById.getLeft();</span><br><span class="line">            right = viewById.getRight();</span><br><span class="line">            bottom = viewById.getBottom();</span><br><span class="line">            top = viewById.getTop();</span><br><span class="line">            width = viewById.getWidth();</span><br><span class="line">            height = viewById.getHeight();</span><br><span class="line">            x = viewById.getX();</span><br><span class="line">            y = viewById.getY();</span><br><span class="line">            translationX = viewById.getTranslationX();</span><br><span class="line">            translationY = viewById.getTranslationY();</span><br><span class="line">            scrollX = viewById.getScrollX();</span><br><span class="line">            scrollY = viewById.getScrollY();</span><br><span class="line"></span><br><span class="line">            Log.i(&quot;第一次： left：&quot;, left + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： right：&quot;, right + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： bottom：&quot;, bottom + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： top：&quot;, top + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： width：&quot;, width + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： height：&quot;, height + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： x：&quot;, x + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： y：&quot;, y + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： translationX：&quot;, translationX + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： translationY：&quot;, translationY + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： scrollX：&quot;, scrollX + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： scrollY：&quot;, scrollY + &quot;&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            ObjectAnimator animator = ObjectAnimator.ofFloat(viewById, &quot;translationX&quot;, 200);</span><br><span class="line">            animator.setDuration(1000);</span><br><span class="line">            animator.addListener(new AnimatorListenerAdapter() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void onAnimationEnd(Animator animation) &#123;</span><br><span class="line">                    super.onAnimationEnd(animation);</span><br><span class="line">                    left = viewById.getLeft();</span><br><span class="line">                    right = viewById.getRight();</span><br><span class="line">                    bottom = viewById.getBottom();</span><br><span class="line">                    top = viewById.getTop();</span><br><span class="line">                    width = viewById.getWidth();</span><br><span class="line">                    height = viewById.getHeight();</span><br><span class="line">                    x = viewById.getX();</span><br><span class="line">                    y = viewById.getY();</span><br><span class="line">                    translationX = viewById.getTranslationX();</span><br><span class="line">                    translationY = viewById.getTranslationY();</span><br><span class="line">                    scrollX = viewById.getScrollX();</span><br><span class="line">                    scrollY = viewById.getScrollY();</span><br><span class="line">                    Log.i(&quot;第二次： ********&quot;, &quot;***************************************************************************&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： left：&quot;, left + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： right：&quot;, right + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： bottom：&quot;, bottom + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： top：&quot;, top + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： width：&quot;, width + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： height：&quot;, height + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： x：&quot;, x + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： y：&quot;, y + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： translationX：&quot;, translationX + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： translationY：&quot;, translationY + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： scrollX：&quot;, scrollX + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： scrollY：&quot;, scrollY + &quot;&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            animator.start();</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        super.onWindowFocusChanged(hasFocus);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： left：: 70</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： right：: 140</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： bottom：: 140</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： top：: 70</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： width：: 70</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： height：: 70</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： x：: 70.0</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： y：: 70.0</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： translationX：: 0.0</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： translationY：: 0.0</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： scrollX：: 0.0</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： scrollY：: 0.0</span><br><span class="line">03-25 22:13:17.314 18794-18794/com.smart.kaifa I/第二次： ********: ***************************************************************************</span><br><span class="line">03-25 22:13:17.314 18794-18794/com.smart.kaifa I/第二次： left：: 70</span><br><span class="line">03-25 22:13:17.314 18794-18794/com.smart.kaifa I/第二次： right：: 140</span><br><span class="line">03-25 22:13:17.315 18794-18794/com.smart.kaifa I/第二次： bottom：: 140</span><br><span class="line">03-25 22:13:17.315 18794-18794/com.smart.kaifa I/第二次： top：: 70</span><br><span class="line">03-25 22:13:17.315 18794-18794/com.smart.kaifa I/第二次： width：: 70</span><br><span class="line">03-25 22:13:17.315 18794-18794/com.smart.kaifa I/第二次： height：: 70</span><br><span class="line">03-25 22:13:17.315 18794-18794/com.smart.kaifa I/第二次： x：: 270.0</span><br><span class="line">03-25 22:13:17.316 18794-18794/com.smart.kaifa I/第二次： y：: 70.0</span><br><span class="line">03-25 22:13:17.316 18794-18794/com.smart.kaifa I/第二次： translationX：: 200.0</span><br><span class="line">03-25 22:13:17.316 18794-18794/com.smart.kaifa I/第二次： translationY：: 0.0</span><br><span class="line">03-25 22:13:17.316 18794-18794/com.smart.kaifa I/第二次： scrollX：: 0.0</span><br><span class="line">03-25 22:13:17.317 18794-18794/com.smart.kaifa I/第二次： scrollY：: 0.0</span><br></pre></td></tr></table></figure>
<p>可以看到:需要注意的是，在View的平移过程中，top和left表示原始右上角的位置信息。其值不会发生改变，此时发生改变的是x，y，translationX和translationY</p>
<p>x=left+translationX<br>y=top+translationY<br>这个是是不变的，交换一下顺序<br>left=x-translationX<br>top=y-translationY</p>
<p>可以这么理解 x是当前相对控件的位置，而translationX是平移的距离。所以他们的差值就是开始的位置</p>
<p>熟悉了控件的摆放位置之后，下面就了解一下用户手指的操作时间</p>
<h2 id="Motion和TouchSlop"><a href="#Motion和TouchSlop" class="headerlink" title="Motion和TouchSlop"></a>Motion和TouchSlop</h2><ol>
<li>MotionEvent<br>这个是手指触摸屏幕后产生的事件：</li>
</ol>
<ul>
<li>ACTION_DOWN： 按下</li>
<li>ACTION_MOVE：移动</li>
<li>ACTION_UP：离开<br>MotionEvent也为我们提供了两种坐标</li>
</ul>
<p>MotionEvent.getX();MotionEvent.getY();  这个返回的是点击位置相对于当前View左上角的x和y坐标<br>MotionEvent.getRawX();MotionEvent.getRawY();这个返回的是点击位置相对于屏幕左上角的坐标</p>
<p>布局<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;FrameLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    xmlns:tools=&quot;http://schemas.android.com/tools&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    android:background=&quot;#00ffff&quot;</span><br><span class="line">    tools:context=&quot;com.smart.kaifa.MainActivity&quot;&gt;</span><br><span class="line">    &lt;FrameLayout</span><br><span class="line">        android:layout_width=&quot;200dp&quot;</span><br><span class="line">        android:layout_height=&quot;400dp&quot;</span><br><span class="line">        android:layout_marginLeft=&quot;100dp&quot;</span><br><span class="line">        android:background=&quot;#ffff00&quot;&gt;</span><br><span class="line">        &lt;com.smart.kaifa.TestTouchView</span><br><span class="line">            android:background=&quot;#ff0000&quot;</span><br><span class="line">            android:id=&quot;@+id/test&quot;</span><br><span class="line">            android:layout_width=&quot;20dp&quot;</span><br><span class="line">            android:layout_marginLeft=&quot;20dp&quot;</span><br><span class="line">            android:layout_marginTop=&quot;20dp&quot;</span><br><span class="line">            android:layout_height=&quot;20dp&quot; /&gt;</span><br><span class="line">    &lt;/FrameLayout&gt;</span><br><span class="line">&lt;/FrameLayout&gt;</span><br></pre></td></tr></table></figure></p>
<p>代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">public class TestTouchView extends android.support.v7.widget.AppCompatTextView &#123;</span><br><span class="line">    public TestTouchView(Context context) &#123;</span><br><span class="line">        super(context);</span><br><span class="line">    &#125;</span><br><span class="line">    public TestTouchView(Context context, AttributeSet attrs) &#123;</span><br><span class="line">        super(context, attrs);</span><br><span class="line">    &#125;</span><br><span class="line">    public TestTouchView(Context context, AttributeSet attrs, int defStyleAttr) &#123;</span><br><span class="line">        super(context, attrs, defStyleAttr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean onTouchEvent(MotionEvent event) &#123;</span><br><span class="line">        Log.i(&quot;x ：&quot;,event.getX()+&quot;&quot;);</span><br><span class="line">        Log.i(&quot;y ：&quot;,event.getY()+&quot;&quot;);</span><br><span class="line">        Log.i(&quot;rawX ：&quot;,event.getRawX()+&quot;&quot;);</span><br><span class="line">        Log.i(&quot;rawY ：&quot;,event.getRawY()+&quot;&quot;);</span><br><span class="line">        return super.onTouchEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">第一次点击</span><br><span class="line">03-25 22:39:10.299 24542-24542/com.smart.kaifa I/x ：: 33.0</span><br><span class="line">03-25 22:39:10.300 24542-24542/com.smart.kaifa I/y ：: 8.0</span><br><span class="line">03-25 22:39:10.300 24542-24542/com.smart.kaifa I/rawX ：: 453.0</span><br><span class="line">03-25 22:39:10.301 24542-24542/com.smart.kaifa I/rawY ：: 358.0</span><br><span class="line"></span><br><span class="line">第二次点击</span><br><span class="line">03-25 22:39:20.016 24542-24542/com.smart.kaifa I/x ：: 39.0</span><br><span class="line">03-25 22:39:20.017 24542-24542/com.smart.kaifa I/y ：: 20.0</span><br><span class="line">03-25 22:39:20.017 24542-24542/com.smart.kaifa I/rawX ：: 459.0</span><br><span class="line">03-25 22:39:20.017 24542-24542/com.smart.kaifa I/rawY ：: 370.0</span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li>TouchSlop<br>这个是系统提供的被认为滑动的最小距离，换句话说,如果一次滑动距离小于这个值，就表示没有滑动，防止手抖，这个是和设备相关的一个变量，每一个设备值可能是不同的，<br><code>ViewConfiguration.get(getContext).getScaledTouchSlop</code>来获取，过滤一些临界值</li>
</ol>
<h2 id="VelocityTracker-GrstureDetrctor和Scroller"><a href="#VelocityTracker-GrstureDetrctor和Scroller" class="headerlink" title="VelocityTracker GrstureDetrctor和Scroller"></a>VelocityTracker GrstureDetrctor和Scroller</h2><ol>
<li>VelocityTracker 用来速度追踪<br>速度追踪，用于追踪手指在滑动过程中的速度，包括水平和竖直方向的速度<br>使用 在view的<code>onTouchEvent</code>中<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public boolean onTouchEvent(MotionEvent event) &#123;</span><br><span class="line">    //设置追踪</span><br><span class="line">    VelocityTracker velocityTracker = VelocityTracker.obtain();</span><br><span class="line">    velocityTracker.addMovement(event);</span><br><span class="line">    // 收获结果</span><br><span class="line">    velocityTracker.computeCurrentVelocity(1000);</span><br><span class="line">    float xVelocity = velocityTracker.getXVelocity();</span><br><span class="line">    float yVelocity= velocityTracker.getYVelocity();</span><br><span class="line">    return super.onTouchEvent(event);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>在一步中有两点要注意：第一点：获取速度之前必须先计算速度<code>velocityTracker.computeCurrentVelocity</code><br>第二点是：这里的速度是指一段时间内手指所滑动过的像素数，比如讲时间间隔设置为1000ms，在1s内手指水平方向滑动100个像素，速度就是100，速度可以是负数，当手指从右往左滑动的时候就是负值：<br>速度=(终点位置-起始位置)/时间<br>不需要的时候要回收<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"> velocityTracker.clear();</span><br><span class="line">velocityTracker.recycle();</span><br></pre></td></tr></table></figure></p>
<ol start="2">
<li>GrstureDetrctor 用来速度追踪<br>手势检测，用于辅助检测用户的单击，滑动，长按，双击等行为<br>使用<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br></pre></td><td class="code"><pre><span class="line">public class TestTouchView extends android.support.v7.widget.AppCompatTextView implements GestureDetector.OnDoubleTapListener &#123;</span><br><span class="line"></span><br><span class="line">    private GestureDetector mGestureDetector;</span><br><span class="line"></span><br><span class="line">    public TestTouchView(Context context) &#123;</span><br><span class="line">        super(context);</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public TestTouchView(Context context, AttributeSet attrs) &#123;</span><br><span class="line">        super(context, attrs);</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void init() &#123;</span><br><span class="line"></span><br><span class="line">        mGestureDetector = new GestureDetector(getContext(), new GestureDetector.SimpleOnGestureListener() &#123;</span><br><span class="line"></span><br><span class="line">            /**</span><br><span class="line">             * 手指按下屏幕会触发</span><br><span class="line">             *</span><br><span class="line">             * @param e</span><br><span class="line">             * @return</span><br><span class="line">             */</span><br><span class="line">            @Override</span><br><span class="line">            public boolean onDown(MotionEvent e) &#123;</span><br><span class="line">                Log.i(&quot;----------------&quot;, &quot;onDown&quot;);</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            /**</span><br><span class="line">             * 手指按下屏幕会触发,还没松开或拖动，由一个ACTION_DOWN触发</span><br><span class="line">             * 注意和onDown的区别，它是一种状态</span><br><span class="line">             *</span><br><span class="line">             * @param e</span><br><span class="line">             * @return</span><br><span class="line">             */</span><br><span class="line">            @Override</span><br><span class="line">            public void onShowPress(MotionEvent e) &#123;</span><br><span class="line">                Log.i(&quot;----------------&quot;, &quot;onShowPress&quot;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            /**</span><br><span class="line">             * 手指（轻轻触摸屏幕后）松开，伴随着1个MotionEvent ACTION_UP 而触发，这个是单击行为</span><br><span class="line">             *</span><br><span class="line">             * @param e</span><br><span class="line">             * @return</span><br><span class="line">             */</span><br><span class="line">            @Override</span><br><span class="line">            public boolean onSingleTapUp(MotionEvent e) &#123;</span><br><span class="line">                Log.i(&quot;----------------&quot;, &quot;onSingleTapUp&quot;);</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            /**</span><br><span class="line">             * 手指按下屏幕并且拖动，有一个ACTION_DOWN和多个ACTION_MOVE触发，这是触动行为</span><br><span class="line">             *</span><br><span class="line">             * @param e1</span><br><span class="line">             * @param e2</span><br><span class="line">             * @param distanceX</span><br><span class="line">             * @param distanceY</span><br><span class="line">             * @return</span><br><span class="line">             */</span><br><span class="line">            @Override</span><br><span class="line">            public boolean onScroll(MotionEvent e1, MotionEvent e2, float distanceX, float distanceY) &#123;</span><br><span class="line">                Log.i(&quot;----------------&quot;, &quot;onScroll&quot;);</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            /**</span><br><span class="line">             * 长久按住屏幕不放，就是长按</span><br><span class="line">             *</span><br><span class="line">             * @param e</span><br><span class="line">             */</span><br><span class="line">            @Override</span><br><span class="line">            public void onLongPress(MotionEvent e) &#123;</span><br><span class="line">                Log.i(&quot;----------------&quot;, &quot;onLongPress&quot;);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            /**</span><br><span class="line">             * 用户按下屏幕，快速滑动后松开，由1个ACTION_DOWN、多个ACTION_MOVE，和一个ACTION_UP组成</span><br><span class="line">             *</span><br><span class="line">             * @param e1</span><br><span class="line">             * @param e2</span><br><span class="line">             * @param velocityX</span><br><span class="line">             * @param velocityY</span><br><span class="line">             * @return</span><br><span class="line">             */</span><br><span class="line">            @Override</span><br><span class="line">            public boolean onFling(MotionEvent e1, MotionEvent e2, float velocityX, float velocityY) &#123;</span><br><span class="line">                Log.i(&quot;----------------&quot;, &quot;onFling&quot;);</span><br><span class="line">                return false;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">        mGestureDetector.setOnDoubleTapListener(this);</span><br><span class="line">        mGestureDetector.setIsLongpressEnabled(false);</span><br><span class="line">        // 这里注意： 要返回true 不然GestureDetector的一些回调不会执行，比如onscroll</span><br><span class="line">        setOnTouchListener(new OnTouchListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public boolean onTouch(View v, MotionEvent event) &#123;</span><br><span class="line">                mGestureDetector.onTouchEvent(event);</span><br><span class="line">                Log.i(&quot;----------------&quot;, &quot;onTouch&quot;);</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public TestTouchView(Context context, AttributeSet attrs, int defStyleAttr) &#123;</span><br><span class="line">        super(context, attrs, defStyleAttr);</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean onTouchEvent(MotionEvent event) &#123;</span><br><span class="line">        Log.i(&quot;----------------&quot;, &quot;onTouchEvent&quot;);</span><br><span class="line">        return mGestureDetector.onTouchEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 严格的单击行为，注意他和onSingleTabUp的区别，如果触发了onSingleTapConfirmed，那么后面不可能在精耕者另一次单击行为，即这只可能是一次单击事件。，而不是双击中的一次单击</span><br><span class="line">     *</span><br><span class="line">     * @param e</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public boolean onSingleTapConfirmed(MotionEvent e) &#123;</span><br><span class="line">        Log.i(&quot;----------------&quot;, &quot;onSingleTapConfirmed&quot;);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 双击，由两次连续的单机组成，他不可能和onSingleTapConfirmed共存</span><br><span class="line">     *</span><br><span class="line">     * @param e</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public boolean onDoubleTap(MotionEvent e) &#123;</span><br><span class="line">        Log.i(&quot;----------------&quot;, &quot;onDoubleTap&quot;);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 表示发生了双击行为，在双击期间，ACTION_DOWN、ACTION_MOVE和ACTION_UP会触发此回调</span><br><span class="line">     *</span><br><span class="line">     * @param e</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public boolean onDoubleTapEvent(MotionEvent e) &#123;</span><br><span class="line">        Log.i(&quot;----------------&quot;, &quot;onDoubleTapEvent&quot;);</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    // 这里也可以拦截</span><br><span class="line">    public boolean dispatchTouchEvent(MotionEvent ev) &#123;</span><br><span class="line">        if (mGestureDetector.onTouchEvent(ev)) &#123;</span><br><span class="line">            return mGestureDetector.onTouchEvent(ev);</span><br><span class="line">        &#125;</span><br><span class="line">        return super.dispatchTouchEvent(ev);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<table>
<thead>
<tr>
<th>方法名</th>
<th style="text-align:center">描述</th>
<th style="text-align:center">所属接口</th>
</tr>
</thead>
<tbody>
<tr>
<td>onDown</td>
<td style="text-align:center">手指按下屏幕会触发</td>
<td style="text-align:center">OnGestureListener</td>
</tr>
<tr>
<td>onShowPress</td>
<td style="text-align:center">手指按下屏幕会触发,还没松开或拖动，由一个ACTION_DOWN触发,注意和onDown的区别，它是一种状态</td>
<td style="text-align:center">OnGestureListener</td>
</tr>
<tr>
<td>onSingleTapUp</td>
<td style="text-align:center">手指（轻轻触摸屏幕后）松开，伴随着1个MotionEvent ACTION_UP 而触发，这个是单击行为</td>
<td style="text-align:center">OnGestureListener</td>
</tr>
<tr>
<td>onScroll</td>
<td style="text-align:center">手指按下屏幕并且拖动，有一个ACTION_DOWN和多个ACTION_MOVE触发，这是触动行为</td>
<td style="text-align:center">OnGestureListener</td>
</tr>
<tr>
<td>onLongPress</td>
<td style="text-align:center">长久按住屏幕不放，就是长按</td>
<td style="text-align:center">OnGestureListener</td>
</tr>
<tr>
<td>onFling</td>
<td style="text-align:center">用户按下屏幕，快速滑动后松开，由1个ACTION_DOWN、多个ACTION_MOVE，和一个ACTION_UP组成</td>
<td style="text-align:center">OnGestureListener</td>
</tr>
<tr>
<td>onSingleTapConfirmed</td>
<td style="text-align:center">严格的单击行为，注意他和onSingleTabUp的区别，如果触发了onSingleTapConfirmed，那么后面不可能在精耕者另一次单击行为，即这只可能是一次单击事件。，而不是双击中的一次单击</td>
<td style="text-align:center">OnDoubleTapListener</td>
</tr>
<tr>
<td>onDoubleTap</td>
<td style="text-align:center">双击，由两次连续的单机组成，他不可能和onSingleTapConfirmed共存</td>
<td style="text-align:center">OnDoubleTapListener</td>
</tr>
<tr>
<td>onDoubleTapEvent</td>
<td style="text-align:center">表示发生了双击行为，在双击期间，ACTION_DOWN、ACTION_MOVE和ACTION_UP会触发此回调</td>
<td style="text-align:center">OnDoubleTapListener</td>
</tr>
</tbody>
</table>
<p>一次单击<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">03-26 22:30:34.055 28182-28182/com.smart.kaifa I/----------------: onDown</span><br><span class="line">03-26 22:30:34.056 28182-28182/com.smart.kaifa I/----------------: onDown</span><br><span class="line">03-26 22:30:34.057 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:34.101 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:34.101 28182-28182/com.smart.kaifa I/----------------: onSingleTapUp</span><br><span class="line">03-26 22:30:34.102 28182-28182/com.smart.kaifa I/----------------: onSingleTapUp</span><br><span class="line">03-26 22:30:34.102 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:34.357 28182-28182/com.smart.kaifa I/----------------: onSingleTapConfirmed</span><br></pre></td></tr></table></figure></p>
<p>一次双击<br>可以看到<code>onSingleTapConfirmed</code>是在最后的调用的，这样就可以在双击中获取单击，防止用户连续点击了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">03-26 22:30:52.937 28182-28182/com.smart.kaifa I/----------------: onDown</span><br><span class="line">03-26 22:30:52.939 28182-28182/com.smart.kaifa I/----------------: onDown</span><br><span class="line">03-26 22:30:52.939 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:52.957 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:52.958 28182-28182/com.smart.kaifa I/----------------: onSingleTapUp</span><br><span class="line">03-26 22:30:52.958 28182-28182/com.smart.kaifa I/----------------: onSingleTapUp</span><br><span class="line">03-26 22:30:52.958 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:53.063 28182-28182/com.smart.kaifa I/----------------: onDoubleTap</span><br><span class="line">03-26 22:30:53.063 28182-28182/com.smart.kaifa I/----------------: onDoubleTapEvent</span><br><span class="line">03-26 22:30:53.063 28182-28182/com.smart.kaifa I/----------------: onDown</span><br><span class="line">03-26 22:30:53.063 28182-28182/com.smart.kaifa I/----------------: onDown</span><br><span class="line">03-26 22:30:53.063 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:53.091 28182-28182/com.smart.kaifa I/----------------: onDoubleTapEvent</span><br><span class="line">03-26 22:30:53.091 28182-28182/com.smart.kaifa I/----------------: onDoubleTapEvent</span><br><span class="line">03-26 22:30:53.091 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:53.101 28182-28182/com.smart.kaifa I/----------------: onDoubleTapEvent</span><br><span class="line">03-26 22:30:53.101 28182-28182/com.smart.kaifa I/----------------: onDoubleTapEvent</span><br><span class="line">03-26 22:30:53.101 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:53.102 28182-28182/com.smart.kaifa I/----------------: onDoubleTapEvent</span><br><span class="line">03-26 22:30:53.102 28182-28182/com.smart.kaifa I/----------------: onSingleTapUp</span><br><span class="line">03-26 22:30:53.102 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:53.363 28182-28182/com.smart.kaifa I/----------------: onSingleTapConfirmed</span><br></pre></td></tr></table></figure></p>
<p>一次移动<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">03-26 22:31:26.057 28182-28182/com.smart.kaifa I/----------------: onDown</span><br><span class="line">03-26 22:31:26.057 28182-28182/com.smart.kaifa I/----------------: onDown</span><br><span class="line">03-26 22:31:26.058 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.147 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.151 28182-28182/com.smart.kaifa I/----------------: onShowPress</span><br><span class="line">03-26 22:31:26.151 28182-28182/com.smart.kaifa I/----------------: onShowPress</span><br><span class="line">03-26 22:31:26.163 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.180 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.180 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.196 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.196 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.213 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.213 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.230 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.230 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.246 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.246 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.263 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.263 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.280 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.280 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.296 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.296 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.313 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.313 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.330 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.330 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.346 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.346 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.363 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.363 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.379 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.380 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.396 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.397 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.413 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.413 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.430 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.430 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.447 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.447 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.463 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.463 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.480 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.480 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.497 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.497 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.513 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.513 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.530 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.530 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.547 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.547 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.563 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.564 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.580 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:31:26.580 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:31:26.597 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br></pre></td></tr></table></figure></p>
<p>一次飞动<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">03-26 22:30:17.226 28182-28182/com.smart.kaifa I/----------------: onDown</span><br><span class="line">03-26 22:30:17.227 28182-28182/com.smart.kaifa I/----------------: onDown</span><br><span class="line">03-26 22:30:17.227 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:17.240 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:17.266 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:30:17.266 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:17.283 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:30:17.283 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:17.300 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:30:17.300 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:17.316 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:30:17.316 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:17.334 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:30:17.334 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:17.344 28182-28182/com.smart.kaifa I/----------------: onScroll</span><br><span class="line">03-26 22:30:17.344 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br><span class="line">03-26 22:30:17.348 28182-28182/com.smart.kaifa I/----------------: onFling</span><br><span class="line">03-26 22:30:17.348 28182-28182/com.smart.kaifa I/----------------: onTouch</span><br></pre></td></tr></table></figure></p>
<h2 id="Scroller"><a href="#Scroller" class="headerlink" title="Scroller"></a>Scroller</h2><p>弹性滑动对象：用于实现view的弹性滑动，当我们使用scrollTo进行滑动的时候，是瞬间完成的，没有过度。体验不好。这个需要View和<code>computerScroll</code>一起</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">public class TestTouchView extends FrameLayout &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private Scroller scroller;</span><br><span class="line"></span><br><span class="line">    public TestTouchView(Context context) &#123;</span><br><span class="line">        super(context);</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public TestTouchView(Context context, AttributeSet attrs) &#123;</span><br><span class="line">        super(context, attrs);</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void init() &#123;</span><br><span class="line"></span><br><span class="line">        scroller = new Scroller(getContext());</span><br><span class="line"></span><br><span class="line">        smoothScrollTo(-1000, 100);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void smoothScrollTo(int x, int y) &#123;</span><br><span class="line">        int x1 = getScrollX();</span><br><span class="line">        int dx = x - x1;</span><br><span class="line">        Log.i(&quot;--------&quot;, &quot;smoothScrollTo&quot;);</span><br><span class="line">        scroller.startScroll(0, 0, dx, 0, 10000);</span><br><span class="line">        invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void computeScroll() &#123;</span><br><span class="line">        if (scroller.computeScrollOffset()) &#123;</span><br><span class="line">            Log.i(&quot;computeScroll CurrX:&quot;, &quot;&quot; + scroller.getCurrX());</span><br><span class="line">            scrollTo(scroller.getCurrX(), scroller.getCurrY());</span><br><span class="line">            postInvalidate();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>记住 scorller针对的对象是TestTouchView内部的东西，和padding类似 ，如果TestTouchView内部由两个控件，那么两个控件都会移动的，还有一点，方向是反方向的，传入<code>scroller.startScroll(0, 0, -1000, 0, 10000)</code>是往右侧移动，可以理解为手机屏幕移动了-1000，但是内容没有移动。</p>
<p>##View的滑动<br>上面简单介绍了View的一些基础知识和概念,现在开始介绍一个很重要的内容：View的滑动，在Android设备上，滑动几乎是应用的标配，不管是下拉刷新还是侧滑<br>这里View的滑动可以归纳为三种方式：</p>
<ul>
<li>第一种是通过View本身提供的scrollTo和scrollBy方法来实现滑动。</li>
<li>第二种是通过动画给View施加平移效果来实现滑动。</li>
<li>第三种是通过改变View的LayoutParams是的View重新布局从而实现滑动</li>
</ul>
<h2 id="第一种：使用View本身提供的scrollTo和scrollBy实现滑动"><a href="#第一种：使用View本身提供的scrollTo和scrollBy实现滑动" class="headerlink" title="第一种：使用View本身提供的scrollTo和scrollBy实现滑动"></a>第一种：使用View本身提供的scrollTo和scrollBy实现滑动</h2><p>这里可以看一下他的源码：他是通过改变scrollx和scrolly的值来改变的，而scrollx和scrolly是可以view的属性，可以通过get和set方法获取和设置的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">// 到某一个具体的位置去，然后将上一次滑动的数值保存</span><br><span class="line">public void scrollTo(int x, int y) &#123;</span><br><span class="line">    if (mScrollX != x || mScrollY != y) &#123;</span><br><span class="line">        int oldX = mScrollX;</span><br><span class="line">        int oldY = mScrollY;</span><br><span class="line">        mScrollX = x;</span><br><span class="line">        mScrollY = y;</span><br><span class="line">        invalidateParentCaches();</span><br><span class="line">        onScrollChanged(mScrollX, mScrollY, oldX, oldY);</span><br><span class="line">        if (!awakenScrollBars()) &#123;</span><br><span class="line">            postInvalidateOnAnimation();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// 一次偏移多少的偏移量，scrollBy其实是调用scrollTo的</span><br><span class="line">public void scrollBy(int x, int y) &#123;</span><br><span class="line">     scrollTo(mScrollX + x, mScrollY + y);</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure></p>
<p>这里要说一下，在滑动过程中，mScrollx始终等于左View边缘和view内容左边缘在水平方向上面的距离的,而mScrollY始终等于View上边缘与内容边缘的竖直方向的距离，mscrollx和mscrolly只能改变 <strong>View内容的位置</strong> 而不能改变View在布局中的位置。并且mScrolly和mScrollX的单位为像素，并且当View左边缘在View内容左边缘的右边的时候，mScrollX为正值，反之为负值。当View上边缘在View内容上边缘下方的时候，mScrollX为正值，反之为负值。换句话说，如果从左向右移动，那么mScrollx为负值，反之为正值。如果从上往下滑动，那么mScrollY为负值，反之为正值。<br>来一张图示意一下。</p>
<p><img src="图像1522504775.png" alt="Alt text" title="示意图"></p>
<p>实心的是view内容，空心的是View的边框，开始的时候实心内容是在View边框中，有一部分是露在外边的，这个时候使用scrollTo移动100px，移动的是View中的内容，边框位置不变，可以看到View的内容就完全显示在View中间了。但是从人的角度来看，View的位置是不动的，所以是View像左移动了100px，就是-100px。和人的感觉是相反的。</p>
<ul>
<li>没有滚动之前的效果</li>
</ul>
<p><img src="device-2018-03-31-224723.png" alt="Alt text" title="效果"></p>
<ul>
<li>一次scrollTo操作，改变的是内容<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    private int left;</span><br><span class="line">    private int right;</span><br><span class="line">    private int bottom;</span><br><span class="line">    private int top;</span><br><span class="line">    private int width;</span><br><span class="line">    private int height;</span><br><span class="line">    private float x;</span><br><span class="line">    private float y;</span><br><span class="line">    private float translationX;</span><br><span class="line">    private float scrollX;</span><br><span class="line">    private float translationY;</span><br><span class="line">    private float scrollY;</span><br><span class="line">    private View viewById;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        viewById = findViewById(R.id.test);</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public void onWindowFocusChanged(boolean hasFocus) &#123;</span><br><span class="line">        // TODO Auto-generated method stub</span><br><span class="line">        if (hasFocus) &#123;</span><br><span class="line">            left = viewById.getLeft();</span><br><span class="line">            right = viewById.getRight();</span><br><span class="line">            bottom = viewById.getBottom();</span><br><span class="line">            top = viewById.getTop();</span><br><span class="line">            width = viewById.getWidth();</span><br><span class="line">            height = viewById.getHeight();</span><br><span class="line">            x = viewById.getX();</span><br><span class="line">            y = viewById.getY();</span><br><span class="line">            translationX = viewById.getTranslationX();</span><br><span class="line">            translationY = viewById.getTranslationY();</span><br><span class="line">            scrollX = viewById.getScrollX();</span><br><span class="line">            scrollY = viewById.getScrollY();</span><br><span class="line">            Log.i(&quot;第一次： left：&quot;, left + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： right：&quot;, right + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： bottom：&quot;, bottom + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： top：&quot;, top + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： width：&quot;, width + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： height：&quot;, height + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： x：&quot;, x + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： y：&quot;, y + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： translationX：&quot;, translationX + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： translationY：&quot;, translationY + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： scrollX：&quot;, scrollX + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： scrollY：&quot;, scrollY + &quot;&quot;);</span><br><span class="line">            Handler handler = new Handler();</span><br><span class="line">            handler.postDelayed(new Runnable() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void run() &#123;</span><br><span class="line">                    runOnUiThread(new Runnable() &#123;</span><br><span class="line">                        @Override</span><br><span class="line">                        public void run() &#123;</span><br><span class="line">                            viewById.scrollTo(-100, -100);</span><br><span class="line">                            left = viewById.getLeft();</span><br><span class="line">                            right = viewById.getRight();</span><br><span class="line">                            bottom = viewById.getBottom();</span><br><span class="line">                            top = viewById.getTop();</span><br><span class="line">                            width = viewById.getWidth();</span><br><span class="line">                            height = viewById.getHeight();</span><br><span class="line">                            x = viewById.getX();</span><br><span class="line">                            y = viewById.getY();</span><br><span class="line">                            translationX = viewById.getTranslationX();</span><br><span class="line">                            translationY = viewById.getTranslationY();</span><br><span class="line">                            scrollX = viewById.getScrollX();</span><br><span class="line">                            scrollY = viewById.getScrollY();</span><br><span class="line">                            Log.i(&quot;第二次： ********&quot;, &quot;***************************************************************************&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： left：&quot;, left + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： right：&quot;, right + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： bottom：&quot;, bottom + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： top：&quot;, top + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： width：&quot;, width + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： height：&quot;, height + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： x：&quot;, x + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： y：&quot;, y + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： translationX：&quot;, translationX + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： translationY：&quot;, translationY + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： scrollX：&quot;, scrollX + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： scrollY：&quot;, scrollY + &quot;&quot;);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, 1000);</span><br><span class="line">        &#125;</span><br><span class="line">        super.onWindowFocusChanged(hasFocus);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>改变的值<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">03-31 22:33:47.107 30190-30190/com.smart.kaifa I/第一次： left：: 0</span><br><span class="line">03-31 22:33:47.107 30190-30190/com.smart.kaifa I/第一次： right：: 700</span><br><span class="line">03-31 22:33:47.107 30190-30190/com.smart.kaifa I/第一次： bottom：: 700</span><br><span class="line">03-31 22:33:47.107 30190-30190/com.smart.kaifa I/第一次： top：: 0</span><br><span class="line">03-31 22:33:47.107 30190-30190/com.smart.kaifa I/第一次： width：: 700</span><br><span class="line">03-31 22:33:47.107 30190-30190/com.smart.kaifa I/第一次： height：: 700</span><br><span class="line">03-31 22:33:47.107 30190-30190/com.smart.kaifa I/第一次： x：: 0.0</span><br><span class="line">03-31 22:33:47.107 30190-30190/com.smart.kaifa I/第一次： y：: 0.0</span><br><span class="line">03-31 22:33:47.107 30190-30190/com.smart.kaifa I/第一次： translationX：: 0.0</span><br><span class="line">03-31 22:33:47.107 30190-30190/com.smart.kaifa I/第一次： translationY：: 0.0</span><br><span class="line">03-31 22:33:47.107 30190-30190/com.smart.kaifa I/第一次： scrollX：: 0.0</span><br><span class="line">03-31 22:33:47.107 30190-30190/com.smart.kaifa I/第一次： scrollY：: 0.0</span><br><span class="line">03-31 22:33:48.110 30190-30190/com.smart.kaifa I/第二次： ********: ***************************************************************************</span><br><span class="line">03-31 22:33:48.110 30190-30190/com.smart.kaifa I/第二次： left：: 0</span><br><span class="line">03-31 22:33:48.110 30190-30190/com.smart.kaifa I/第二次： right：: 700</span><br><span class="line">03-31 22:33:48.110 30190-30190/com.smart.kaifa I/第二次： bottom：: 700</span><br><span class="line">03-31 22:33:48.110 30190-30190/com.smart.kaifa I/第二次： top：: 0</span><br><span class="line">03-31 22:33:48.111 30190-30190/com.smart.kaifa I/第二次： width：: 700</span><br><span class="line">03-31 22:33:48.111 30190-30190/com.smart.kaifa I/第二次： height：: 700</span><br><span class="line">03-31 22:33:48.111 30190-30190/com.smart.kaifa I/第二次： x：: 0.0</span><br><span class="line">03-31 22:33:48.111 30190-30190/com.smart.kaifa I/第二次： y：: 0.0</span><br><span class="line">03-31 22:33:48.111 30190-30190/com.smart.kaifa I/第二次： translationX：: 0.0</span><br><span class="line">03-31 22:33:48.111 30190-30190/com.smart.kaifa I/第二次： translationY：: 0.0</span><br><span class="line">03-31 22:33:48.111 30190-30190/com.smart.kaifa I/第二次： scrollX：: -100.0</span><br><span class="line">03-31 22:33:48.112 30190-30190/com.smart.kaifa I/第二次： scrollY：: -100.0</span><br></pre></td></tr></table></figure></p>
<p><img src="device-2018-03-31-224548.png" alt="Alt text" title="效果"></p>
<ul>
<li>如果直接修改scorllx和scrolly的属性,这个效果和scrollto的效果是一样的<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    private int left;</span><br><span class="line">    private int right;</span><br><span class="line">    private int bottom;</span><br><span class="line">    private int top;</span><br><span class="line">    private int width;</span><br><span class="line">    private int height;</span><br><span class="line">    private float x;</span><br><span class="line">    private float y;</span><br><span class="line">    private float translationX;</span><br><span class="line">    private float scrollX;</span><br><span class="line">    private float translationY;</span><br><span class="line">    private float scrollY;</span><br><span class="line">    private View viewById;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        viewById = findViewById(R.id.test);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onWindowFocusChanged(boolean hasFocus) &#123;</span><br><span class="line">        // TODO Auto-generated method stub</span><br><span class="line">        if (hasFocus) &#123;</span><br><span class="line">            left = viewById.getLeft();</span><br><span class="line">            right = viewById.getRight();</span><br><span class="line">            bottom = viewById.getBottom();</span><br><span class="line">            top = viewById.getTop();</span><br><span class="line">            width = viewById.getWidth();</span><br><span class="line">            height = viewById.getHeight();</span><br><span class="line">            x = viewById.getX();</span><br><span class="line">            y = viewById.getY();</span><br><span class="line">            translationX = viewById.getTranslationX();</span><br><span class="line">            translationY = viewById.getTranslationY();</span><br><span class="line">            scrollX = viewById.getScrollX();</span><br><span class="line">            scrollY = viewById.getScrollY();</span><br><span class="line"></span><br><span class="line">            Log.i(&quot;第一次： left：&quot;, left + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： right：&quot;, right + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： bottom：&quot;, bottom + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： top：&quot;, top + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： width：&quot;, width + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： height：&quot;, height + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： x：&quot;, x + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： y：&quot;, y + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： translationX：&quot;, translationX + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： translationY：&quot;, translationY + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： scrollX：&quot;, scrollX + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： scrollY：&quot;, scrollY + &quot;&quot;);</span><br><span class="line"></span><br><span class="line">            Handler handler = new Handler();</span><br><span class="line">            handler.postDelayed(new Runnable() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void run() &#123;</span><br><span class="line">                    runOnUiThread(new Runnable() &#123;</span><br><span class="line">                        @Override</span><br><span class="line">                        public void run() &#123;</span><br><span class="line">                            viewById.setScrollY(-100);</span><br><span class="line">                            viewById.setScrollX(-100);</span><br><span class="line">                            left = viewById.getLeft();</span><br><span class="line">                            right = viewById.getRight();</span><br><span class="line">                            bottom = viewById.getBottom();</span><br><span class="line">                            top = viewById.getTop();</span><br><span class="line">                            width = viewById.getWidth();</span><br><span class="line">                            height = viewById.getHeight();</span><br><span class="line">                            x = viewById.getX();</span><br><span class="line">                            y = viewById.getY();</span><br><span class="line">                            translationX = viewById.getTranslationX();</span><br><span class="line">                            translationY = viewById.getTranslationY();</span><br><span class="line">                            scrollX = viewById.getScrollX();</span><br><span class="line">                            scrollY = viewById.getScrollY();</span><br><span class="line">                            Log.i(&quot;第二次： ********&quot;, &quot;***************************************************************************&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： left：&quot;, left + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： right：&quot;, right + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： bottom：&quot;, bottom + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： top：&quot;, top + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： width：&quot;, width + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： height：&quot;, height + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： x：&quot;, x + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： y：&quot;, y + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： translationX：&quot;, translationX + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： translationY：&quot;, translationY + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： scrollX：&quot;, scrollX + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： scrollY：&quot;, scrollY + &quot;&quot;);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, 1000);</span><br><span class="line">        &#125;</span><br><span class="line">        super.onWindowFocusChanged(hasFocus);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">03-31 22:37:05.765 31212-31212/com.smart.kaifa I/第一次： left：: 0</span><br><span class="line">03-31 22:37:05.765 31212-31212/com.smart.kaifa I/第一次： right：: 700</span><br><span class="line">03-31 22:37:05.765 31212-31212/com.smart.kaifa I/第一次： bottom：: 700</span><br><span class="line">03-31 22:37:05.765 31212-31212/com.smart.kaifa I/第一次： top：: 0</span><br><span class="line">03-31 22:37:05.765 31212-31212/com.smart.kaifa I/第一次： width：: 700</span><br><span class="line">03-31 22:37:05.765 31212-31212/com.smart.kaifa I/第一次： height：: 700</span><br><span class="line">03-31 22:37:05.766 31212-31212/com.smart.kaifa I/第一次： x：: 0.0</span><br><span class="line">03-31 22:37:05.766 31212-31212/com.smart.kaifa I/第一次： y：: 0.0</span><br><span class="line">03-31 22:37:05.766 31212-31212/com.smart.kaifa I/第一次： translationX：: 0.0</span><br><span class="line">03-31 22:37:05.766 31212-31212/com.smart.kaifa I/第一次： translationY：: 0.0</span><br><span class="line">03-31 22:37:05.766 31212-31212/com.smart.kaifa I/第一次： scrollX：: 0.0</span><br><span class="line">03-31 22:37:05.766 31212-31212/com.smart.kaifa I/第一次： scrollY：: 0.0</span><br><span class="line">03-31 22:37:06.768 31212-31212/com.smart.kaifa I/第二次： ********: ***************************************************************************</span><br><span class="line">03-31 22:37:06.768 31212-31212/com.smart.kaifa I/第二次： left：: 0</span><br><span class="line">03-31 22:37:06.768 31212-31212/com.smart.kaifa I/第二次： right：: 700</span><br><span class="line">03-31 22:37:06.768 31212-31212/com.smart.kaifa I/第二次： bottom：: 700</span><br><span class="line">03-31 22:37:06.768 31212-31212/com.smart.kaifa I/第二次： top：: 0</span><br><span class="line">03-31 22:37:06.768 31212-31212/com.smart.kaifa I/第二次： width：: 700</span><br><span class="line">03-31 22:37:06.768 31212-31212/com.smart.kaifa I/第二次： height：: 700</span><br><span class="line">03-31 22:37:06.769 31212-31212/com.smart.kaifa I/第二次： x：: 0.0</span><br><span class="line">03-31 22:37:06.769 31212-31212/com.smart.kaifa I/第二次： y：: 0.0</span><br><span class="line">03-31 22:37:06.769 31212-31212/com.smart.kaifa I/第二次： translationX：: 0.0</span><br><span class="line">03-31 22:37:06.769 31212-31212/com.smart.kaifa I/第二次： translationY：: 0.0</span><br><span class="line">03-31 22:37:06.769 31212-31212/com.smart.kaifa I/第二次： scrollX：: -100.0</span><br><span class="line">03-31 22:37:06.769 31212-31212/com.smart.kaifa I/第二次： scrollY：: -100.0</span><br></pre></td></tr></table></figure>
<p><img src="device-2018-03-31-224548.png" alt="Alt text" title="效果"></p>
<ul>
<li>如果使用TranslationX平移100 是view的边框平移100<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    private int left;</span><br><span class="line">    private int right;</span><br><span class="line">    private int bottom;</span><br><span class="line">    private int top;</span><br><span class="line">    private int width;</span><br><span class="line">    private int height;</span><br><span class="line">    private float x;</span><br><span class="line">    private float y;</span><br><span class="line">    private float translationX;</span><br><span class="line">    private float scrollX;</span><br><span class="line">    private float translationY;</span><br><span class="line">    private float scrollY;</span><br><span class="line">    private View viewById;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        viewById = findViewById(R.id.test);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onWindowFocusChanged(boolean hasFocus) &#123;</span><br><span class="line">        // TODO Auto-generated method stub</span><br><span class="line">        if (hasFocus) &#123;</span><br><span class="line">            left = viewById.getLeft();</span><br><span class="line">            right = viewById.getRight();</span><br><span class="line">            bottom = viewById.getBottom();</span><br><span class="line">            top = viewById.getTop();</span><br><span class="line">            width = viewById.getWidth();</span><br><span class="line">            height = viewById.getHeight();</span><br><span class="line">            x = viewById.getX();</span><br><span class="line">            y = viewById.getY();</span><br><span class="line">            translationX = viewById.getTranslationX();</span><br><span class="line">            translationY = viewById.getTranslationY();</span><br><span class="line">            scrollX = viewById.getScrollX();</span><br><span class="line">            scrollY = viewById.getScrollY();</span><br><span class="line"></span><br><span class="line">            Log.i(&quot;第一次： left：&quot;, left + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： right：&quot;, right + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： bottom：&quot;, bottom + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： top：&quot;, top + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： width：&quot;, width + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： height：&quot;, height + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： x：&quot;, x + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： y：&quot;, y + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： translationX：&quot;, translationX + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： translationY：&quot;, translationY + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： scrollX：&quot;, scrollX + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： scrollY：&quot;, scrollY + &quot;&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            Handler handler = new Handler();</span><br><span class="line">            handler.postDelayed(new Runnable() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void run() &#123;</span><br><span class="line">                    runOnUiThread(new Runnable() &#123;</span><br><span class="line">                        @Override</span><br><span class="line">                        public void run() &#123;</span><br><span class="line">                            viewById.setTranslationX(100);//重点</span><br><span class="line">                            viewById.setTranslationY(100);//重点</span><br><span class="line">                            left = viewById.getLeft();</span><br><span class="line">                            right = viewById.getRight();</span><br><span class="line">                            bottom = viewById.getBottom();</span><br><span class="line">                            top = viewById.getTop();</span><br><span class="line">                            width = viewById.getWidth();</span><br><span class="line">                            height = viewById.getHeight();</span><br><span class="line">                            x = viewById.getX();</span><br><span class="line">                            y = viewById.getY();</span><br><span class="line">                            translationX = viewById.getTranslationX();</span><br><span class="line">                            translationY = viewById.getTranslationY();</span><br><span class="line">                            scrollX = viewById.getScrollX();</span><br><span class="line">                            scrollY = viewById.getScrollY();</span><br><span class="line">                            Log.i(&quot;第二次： ********&quot;, &quot;***************************************************************************&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： left：&quot;, left + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： right：&quot;, right + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： bottom：&quot;, bottom + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： top：&quot;, top + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： width：&quot;, width + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： height：&quot;, height + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： x：&quot;, x + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： y：&quot;, y + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： translationX：&quot;, translationX + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： translationY：&quot;, translationY + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： scrollX：&quot;, scrollX + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： scrollY：&quot;, scrollY + &quot;&quot;);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, 1000);</span><br><span class="line">        &#125;</span><br><span class="line">        super.onWindowFocusChanged(hasFocus);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">03-31 22:39:21.987 31988-31988/com.smart.kaifa I/第一次： left：: 0</span><br><span class="line">03-31 22:39:21.987 31988-31988/com.smart.kaifa I/第一次： right：: 700</span><br><span class="line">03-31 22:39:21.987 31988-31988/com.smart.kaifa I/第一次： bottom：: 700</span><br><span class="line">03-31 22:39:21.987 31988-31988/com.smart.kaifa I/第一次： top：: 0</span><br><span class="line">03-31 22:39:21.987 31988-31988/com.smart.kaifa I/第一次： width：: 700</span><br><span class="line">03-31 22:39:21.987 31988-31988/com.smart.kaifa I/第一次： height：: 700</span><br><span class="line">03-31 22:39:21.987 31988-31988/com.smart.kaifa I/第一次： x：: 0.0</span><br><span class="line">03-31 22:39:21.987 31988-31988/com.smart.kaifa I/第一次： y：: 0.0</span><br><span class="line">03-31 22:39:21.987 31988-31988/com.smart.kaifa I/第一次： translationX：: 0.0</span><br><span class="line">03-31 22:39:21.987 31988-31988/com.smart.kaifa I/第一次： translationY：: 0.0</span><br><span class="line">03-31 22:39:21.987 31988-31988/com.smart.kaifa I/第一次： scrollX：: 0.0</span><br><span class="line">03-31 22:39:21.987 31988-31988/com.smart.kaifa I/第一次： scrollY：: 0.0</span><br><span class="line">03-31 22:39:22.990 31988-31988/com.smart.kaifa I/第二次： ********: ***************************************************************************</span><br><span class="line">03-31 22:39:22.990 31988-31988/com.smart.kaifa I/第二次： left：: 0</span><br><span class="line">03-31 22:39:22.990 31988-31988/com.smart.kaifa I/第二次： right：: 700</span><br><span class="line">03-31 22:39:22.991 31988-31988/com.smart.kaifa I/第二次： bottom：: 700</span><br><span class="line">03-31 22:39:22.991 31988-31988/com.smart.kaifa I/第二次： top：: 0</span><br><span class="line">03-31 22:39:22.991 31988-31988/com.smart.kaifa I/第二次： width：: 700</span><br><span class="line">03-31 22:39:22.991 31988-31988/com.smart.kaifa I/第二次： height：: 700</span><br><span class="line">03-31 22:39:22.991 31988-31988/com.smart.kaifa I/第二次： x：: 100.0</span><br><span class="line">03-31 22:39:22.992 31988-31988/com.smart.kaifa I/第二次： y：: 100.0</span><br><span class="line">03-31 22:39:22.992 31988-31988/com.smart.kaifa I/第二次： translationX：: 100.0</span><br><span class="line">03-31 22:39:22.992 31988-31988/com.smart.kaifa I/第二次： translationY：: 100.0</span><br><span class="line">03-31 22:39:22.992 31988-31988/com.smart.kaifa I/第二次： scrollX：: 0.0</span><br><span class="line">03-31 22:39:22.992 31988-31988/com.smart.kaifa I/第二次： scrollY：: 0.0</span><br></pre></td></tr></table></figure>
<p><img src="device-2018-03-31-224323.png" alt="Alt text" title="效果"></p>
<ul>
<li>修改x和y的属性<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    private int left;</span><br><span class="line">    private int right;</span><br><span class="line">    private int bottom;</span><br><span class="line">    private int top;</span><br><span class="line">    private int width;</span><br><span class="line">    private int height;</span><br><span class="line">    private float x;</span><br><span class="line">    private float y;</span><br><span class="line">    private float translationX;</span><br><span class="line">    private float scrollX;</span><br><span class="line">    private float translationY;</span><br><span class="line">    private float scrollY;</span><br><span class="line">    private View viewById;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        viewById = findViewById(R.id.test);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onWindowFocusChanged(boolean hasFocus) &#123;</span><br><span class="line">        // TODO Auto-generated method stub</span><br><span class="line">        if (hasFocus) &#123;</span><br><span class="line">            left = viewById.getLeft();</span><br><span class="line">            right = viewById.getRight();</span><br><span class="line">            bottom = viewById.getBottom();</span><br><span class="line">            top = viewById.getTop();</span><br><span class="line">            width = viewById.getWidth();</span><br><span class="line">            height = viewById.getHeight();</span><br><span class="line">            x = viewById.getX();</span><br><span class="line">            y = viewById.getY();</span><br><span class="line">            translationX = viewById.getTranslationX();</span><br><span class="line">            translationY = viewById.getTranslationY();</span><br><span class="line">            scrollX = viewById.getScrollX();</span><br><span class="line">            scrollY = viewById.getScrollY();</span><br><span class="line"></span><br><span class="line">            Log.i(&quot;第一次： left：&quot;, left + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： right：&quot;, right + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： bottom：&quot;, bottom + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： top：&quot;, top + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： width：&quot;, width + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： height：&quot;, height + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： x：&quot;, x + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： y：&quot;, y + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： translationX：&quot;, translationX + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： translationY：&quot;, translationY + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： scrollX：&quot;, scrollX + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： scrollY：&quot;, scrollY + &quot;&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            Handler handler = new Handler();</span><br><span class="line">            handler.postDelayed(new Runnable() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void run() &#123;</span><br><span class="line">                    runOnUiThread(new Runnable() &#123;</span><br><span class="line">                        @Override</span><br><span class="line">                        public void run() &#123;</span><br><span class="line">                            viewById.setX(100);</span><br><span class="line">                            viewById.setY(100);</span><br><span class="line">                            left = viewById.getLeft();</span><br><span class="line">                            right = viewById.getRight();</span><br><span class="line">                            bottom = viewById.getBottom();</span><br><span class="line">                            top = viewById.getTop();</span><br><span class="line">                            width = viewById.getWidth();</span><br><span class="line">                            height = viewById.getHeight();</span><br><span class="line">                            x = viewById.getX();</span><br><span class="line">                            y = viewById.getY();</span><br><span class="line">                            translationX = viewById.getTranslationX();</span><br><span class="line">                            translationY = viewById.getTranslationY();</span><br><span class="line">                            scrollX = viewById.getScrollX();</span><br><span class="line">                            scrollY = viewById.getScrollY();</span><br><span class="line">                            Log.i(&quot;第二次： ********&quot;, &quot;***************************************************************************&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： left：&quot;, left + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： right：&quot;, right + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： bottom：&quot;, bottom + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： top：&quot;, top + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： width：&quot;, width + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： height：&quot;, height + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： x：&quot;, x + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： y：&quot;, y + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： translationX：&quot;, translationX + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： translationY：&quot;, translationY + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： scrollX：&quot;, scrollX + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： scrollY：&quot;, scrollY + &quot;&quot;);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, 1000);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        super.onWindowFocusChanged(hasFocus);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>如果修改x和y的值，会导致translationX和translationY的值相应改变，<br>x=left+translationX<br>y=top+translationY<br>这个关系式是不变的，而left和top是控件的固有属性，在平移的过程之中不会发生变化，所以x和translationX会相对线性的改变<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">03-31 22:46:29.420 1993-1993/com.smart.kaifa I/第一次： left：: 0</span><br><span class="line">03-31 22:46:29.420 1993-1993/com.smart.kaifa I/第一次： right：: 700</span><br><span class="line">03-31 22:46:29.420 1993-1993/com.smart.kaifa I/第一次： bottom：: 700</span><br><span class="line">03-31 22:46:29.420 1993-1993/com.smart.kaifa I/第一次： top：: 0</span><br><span class="line">03-31 22:46:29.420 1993-1993/com.smart.kaifa I/第一次： width：: 700</span><br><span class="line">03-31 22:46:29.420 1993-1993/com.smart.kaifa I/第一次： height：: 700</span><br><span class="line">03-31 22:46:29.421 1993-1993/com.smart.kaifa I/第一次： x：: 0.0</span><br><span class="line">03-31 22:46:29.421 1993-1993/com.smart.kaifa I/第一次： y：: 0.0</span><br><span class="line">03-31 22:46:29.421 1993-1993/com.smart.kaifa I/第一次： translationX：: 0.0</span><br><span class="line">03-31 22:46:29.421 1993-1993/com.smart.kaifa I/第一次： translationY：: 0.0</span><br><span class="line">03-31 22:46:29.421 1993-1993/com.smart.kaifa I/第一次： scrollX：: 0.0</span><br><span class="line">03-31 22:46:29.421 1993-1993/com.smart.kaifa I/第一次： scrollY：: 0.0</span><br><span class="line">03-31 22:46:30.424 1993-1993/com.smart.kaifa I/第二次： ********: ***************************************************************************</span><br><span class="line">03-31 22:46:30.424 1993-1993/com.smart.kaifa I/第二次： left：: 0</span><br><span class="line">03-31 22:46:30.425 1993-1993/com.smart.kaifa I/第二次： right：: 700</span><br><span class="line">03-31 22:46:30.425 1993-1993/com.smart.kaifa I/第二次： bottom：: 700</span><br><span class="line">03-31 22:46:30.425 1993-1993/com.smart.kaifa I/第二次： top：: 0</span><br><span class="line">03-31 22:46:30.425 1993-1993/com.smart.kaifa I/第二次： width：: 700</span><br><span class="line">03-31 22:46:30.425 1993-1993/com.smart.kaifa I/第二次： height：: 700</span><br><span class="line">03-31 22:46:30.425 1993-1993/com.smart.kaifa I/第二次： x：: 100.0</span><br><span class="line">03-31 22:46:30.426 1993-1993/com.smart.kaifa I/第二次： y：: 100.0</span><br><span class="line">03-31 22:46:30.426 1993-1993/com.smart.kaifa I/第二次： translationX：: 100.0</span><br><span class="line">03-31 22:46:30.426 1993-1993/com.smart.kaifa I/第二次： translationY：: 100.0</span><br><span class="line">03-31 22:46:30.426 1993-1993/com.smart.kaifa I/第二次： scrollX：: 0.0</span><br><span class="line">03-31 22:46:30.426 1993-1993/com.smart.kaifa I/第二次： scrollY：: 0.0</span><br></pre></td></tr></table></figure></p>
<p><img src="device-2018-03-31-224323.png" alt="Alt text" title="效果"></p>
<h2 id="第二种：属性动画，属性动画是改变View的属性值"><a href="#第二种：属性动画，属性动画是改变View的属性值" class="headerlink" title="第二种：属性动画，属性动画是改变View的属性值"></a>第二种：属性动画，属性动画是改变View的属性值</h2><p>如果是android3.0以下的版本可以使用nineoldandroids ，但是现在已经基本上不用兼容android2.3的版本了<br>上面已经有一个demo了</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    private int left;</span><br><span class="line">    private int right;</span><br><span class="line">    private int bottom;</span><br><span class="line">    private int top;</span><br><span class="line">    private int width;</span><br><span class="line">    private int height;</span><br><span class="line">    private float x;</span><br><span class="line">    private float y;</span><br><span class="line">    private float translationX;</span><br><span class="line">    private float scrollX;</span><br><span class="line">    private float translationY;</span><br><span class="line">    private float scrollY;</span><br><span class="line">    private View viewById;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        viewById = findViewById(R.id.test);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onWindowFocusChanged(boolean hasFocus) &#123;</span><br><span class="line">        // TODO Auto-generated method stub</span><br><span class="line">        if(hasFocus)&#123;</span><br><span class="line">            left = viewById.getLeft();</span><br><span class="line">            right = viewById.getRight();</span><br><span class="line">            bottom = viewById.getBottom();</span><br><span class="line">            top = viewById.getTop();</span><br><span class="line">            width = viewById.getWidth();</span><br><span class="line">            height = viewById.getHeight();</span><br><span class="line">            x = viewById.getX();</span><br><span class="line">            y = viewById.getY();</span><br><span class="line">            translationX = viewById.getTranslationX();</span><br><span class="line">            translationY = viewById.getTranslationY();</span><br><span class="line">            scrollX = viewById.getScrollX();</span><br><span class="line">            scrollY = viewById.getScrollY();</span><br><span class="line"></span><br><span class="line">            Log.i(&quot;第一次： left：&quot;, left + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： right：&quot;, right + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： bottom：&quot;, bottom + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： top：&quot;, top + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： width：&quot;, width + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： height：&quot;, height + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： x：&quot;, x + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： y：&quot;, y + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： translationX：&quot;, translationX + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： translationY：&quot;, translationY + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： scrollX：&quot;, scrollX + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： scrollY：&quot;, scrollY + &quot;&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">            ObjectAnimator animator = ObjectAnimator.ofFloat(viewById, &quot;translationX&quot;, 200);</span><br><span class="line">            animator.setDuration(1000);</span><br><span class="line">            animator.addListener(new AnimatorListenerAdapter() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void onAnimationEnd(Animator animation) &#123;</span><br><span class="line">                    super.onAnimationEnd(animation);</span><br><span class="line">                    left = viewById.getLeft();</span><br><span class="line">                    right = viewById.getRight();</span><br><span class="line">                    bottom = viewById.getBottom();</span><br><span class="line">                    top = viewById.getTop();</span><br><span class="line">                    width = viewById.getWidth();</span><br><span class="line">                    height = viewById.getHeight();</span><br><span class="line">                    x = viewById.getX();</span><br><span class="line">                    y = viewById.getY();</span><br><span class="line">                    translationX = viewById.getTranslationX();</span><br><span class="line">                    translationY = viewById.getTranslationY();</span><br><span class="line">                    scrollX = viewById.getScrollX();</span><br><span class="line">                    scrollY = viewById.getScrollY();</span><br><span class="line">                    Log.i(&quot;第二次： ********&quot;, &quot;***************************************************************************&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： left：&quot;, left + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： right：&quot;, right + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： bottom：&quot;, bottom + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： top：&quot;, top + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： width：&quot;, width + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： height：&quot;, height + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： x：&quot;, x + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： y：&quot;, y + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： translationX：&quot;, translationX + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： translationY：&quot;, translationY + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： scrollX：&quot;, scrollX + &quot;&quot;);</span><br><span class="line">                    Log.i(&quot;第二次： scrollY：&quot;, scrollY + &quot;&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">            animator.start();</span><br><span class="line">        &#125;</span><br><span class="line">        super.onWindowFocusChanged(hasFocus);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： left：: 70</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： right：: 140</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： bottom：: 140</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： top：: 70</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： width：: 70</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： height：: 70</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： x：: 70.0</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： y：: 70.0</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： translationX：: 0.0</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： translationY：: 0.0</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： scrollX：: 0.0</span><br><span class="line">03-25 22:13:16.307 18794-18794/com.smart.kaifa I/第一次： scrollY：: 0.0</span><br><span class="line">03-25 22:13:17.314 18794-18794/com.smart.kaifa I/第二次： ********: ***************************************************************************</span><br><span class="line">03-25 22:13:17.314 18794-18794/com.smart.kaifa I/第二次： left：: 70</span><br><span class="line">03-25 22:13:17.314 18794-18794/com.smart.kaifa I/第二次： right：: 140</span><br><span class="line">03-25 22:13:17.315 18794-18794/com.smart.kaifa I/第二次： bottom：: 140</span><br><span class="line">03-25 22:13:17.315 18794-18794/com.smart.kaifa I/第二次： top：: 70</span><br><span class="line">03-25 22:13:17.315 18794-18794/com.smart.kaifa I/第二次： width：: 70</span><br><span class="line">03-25 22:13:17.315 18794-18794/com.smart.kaifa I/第二次： height：: 70</span><br><span class="line">03-25 22:13:17.315 18794-18794/com.smart.kaifa I/第二次： x：: 270.0</span><br><span class="line">03-25 22:13:17.316 18794-18794/com.smart.kaifa I/第二次： y：: 70.0</span><br><span class="line">03-25 22:13:17.316 18794-18794/com.smart.kaifa I/第二次： translationX：: 200.0</span><br><span class="line">03-25 22:13:17.316 18794-18794/com.smart.kaifa I/第二次： translationY：: 0.0</span><br><span class="line">03-25 22:13:17.316 18794-18794/com.smart.kaifa I/第二次： scrollX：: 0.0</span><br><span class="line">03-25 22:13:17.317 18794-18794/com.smart.kaifa I/第二次： scrollY：: 0.0</span><br></pre></td></tr></table></figure></p>
<p>属性动画和普通动画的区别在于普通动画移动之后由于没有改变属性值，只是视觉效果变化，这个时候点击事件任然保留在原地，而属性动画点击事件和视觉效果一致</p>
<h2 id="使用布局参数，就是修改LayoutParams"><a href="#使用布局参数，就是修改LayoutParams" class="headerlink" title="使用布局参数，就是修改LayoutParams"></a>使用布局参数，就是修改LayoutParams</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    private int left;</span><br><span class="line">    private int right;</span><br><span class="line">    private int bottom;</span><br><span class="line">    private int top;</span><br><span class="line">    private int width;</span><br><span class="line">    private int height;</span><br><span class="line">    private float x;</span><br><span class="line">    private float y;</span><br><span class="line">    private float translationX;</span><br><span class="line">    private float scrollX;</span><br><span class="line">    private float translationY;</span><br><span class="line">    private float scrollY;</span><br><span class="line">    private View viewById;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        viewById = findViewById(R.id.test);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onWindowFocusChanged(boolean hasFocus) &#123;</span><br><span class="line">        // TODO Auto-generated method stub</span><br><span class="line">        if (hasFocus) &#123;</span><br><span class="line">            left = viewById.getLeft();</span><br><span class="line">            right = viewById.getRight();</span><br><span class="line">            bottom = viewById.getBottom();</span><br><span class="line">            top = viewById.getTop();</span><br><span class="line">            width = viewById.getWidth();</span><br><span class="line">            height = viewById.getHeight();</span><br><span class="line">            x = viewById.getX();</span><br><span class="line">            y = viewById.getY();</span><br><span class="line">            translationX = viewById.getTranslationX();</span><br><span class="line">            translationY = viewById.getTranslationY();</span><br><span class="line">            scrollX = viewById.getScrollX();</span><br><span class="line">            scrollY = viewById.getScrollY();</span><br><span class="line"></span><br><span class="line">            Log.i(&quot;第一次： left：&quot;, left + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： right：&quot;, right + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： bottom：&quot;, bottom + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： top：&quot;, top + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： width：&quot;, width + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： height：&quot;, height + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： x：&quot;, x + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： y：&quot;, y + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： translationX：&quot;, translationX + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： translationY：&quot;, translationY + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： scrollX：&quot;, scrollX + &quot;&quot;);</span><br><span class="line">            Log.i(&quot;第一次： scrollY：&quot;, scrollY + &quot;&quot;);</span><br><span class="line"></span><br><span class="line">            Handler handler = new Handler();</span><br><span class="line">            handler.postDelayed(new Runnable() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                public void run() &#123;</span><br><span class="line">                    runOnUiThread(new Runnable() &#123;</span><br><span class="line">                        @Override</span><br><span class="line">                        public void run() &#123;</span><br><span class="line">                            ViewGroup.MarginLayoutParams layoutParams = (ViewGroup.MarginLayoutParams) viewById.getLayoutParams();</span><br><span class="line">                            layoutParams.width += 500;</span><br><span class="line">                            layoutParams.leftMargin += 100;</span><br><span class="line">                            viewById.setLayoutParams(layoutParams);</span><br><span class="line">                            left = viewById.getLeft();</span><br><span class="line">                            right = viewById.getRight();</span><br><span class="line">                            bottom = viewById.getBottom();</span><br><span class="line">                            top = viewById.getTop();</span><br><span class="line">                            width = viewById.getWidth();</span><br><span class="line">                            height = viewById.getHeight();</span><br><span class="line">                            x = viewById.getX();</span><br><span class="line">                            y = viewById.getY();</span><br><span class="line">                            translationX = viewById.getTranslationX();</span><br><span class="line">                            translationY = viewById.getTranslationY();</span><br><span class="line">                            scrollX = viewById.getScrollX();</span><br><span class="line">                            scrollY = viewById.getScrollY();</span><br><span class="line">                            Log.i(&quot;第二次： ********&quot;, &quot;***************************************************************************&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： left：&quot;, left + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： right：&quot;, right + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： bottom：&quot;, bottom + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： top：&quot;, top + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： width：&quot;, width + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： height：&quot;, height + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： x：&quot;, x + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： y：&quot;, y + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： translationX：&quot;, translationX + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： translationY：&quot;, translationY + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： scrollX：&quot;, scrollX + &quot;&quot;);</span><br><span class="line">                            Log.i(&quot;第二次： scrollY：&quot;, scrollY + &quot;&quot;);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;, 1000);</span><br><span class="line">        &#125;</span><br><span class="line">        super.onWindowFocusChanged(hasFocus);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">03-31 23:13:47.225 10457-10457/com.smart.kaifa I/第一次： left：: 0</span><br><span class="line">03-31 23:13:47.225 10457-10457/com.smart.kaifa I/第一次： right：: 700</span><br><span class="line">03-31 23:13:47.225 10457-10457/com.smart.kaifa I/第一次： bottom：: 700</span><br><span class="line">03-31 23:13:47.225 10457-10457/com.smart.kaifa I/第一次： top：: 0</span><br><span class="line">03-31 23:13:47.225 10457-10457/com.smart.kaifa I/第一次： width：: 700</span><br><span class="line">03-31 23:13:47.225 10457-10457/com.smart.kaifa I/第一次： height：: 700</span><br><span class="line">03-31 23:13:47.225 10457-10457/com.smart.kaifa I/第一次： x：: 0.0</span><br><span class="line">03-31 23:13:47.225 10457-10457/com.smart.kaifa I/第一次： y：: 0.0</span><br><span class="line">03-31 23:13:47.225 10457-10457/com.smart.kaifa I/第一次： translationX：: 0.0</span><br><span class="line">03-31 23:13:47.225 10457-10457/com.smart.kaifa I/第一次： translationY：: 0.0</span><br><span class="line">03-31 23:13:47.226 10457-10457/com.smart.kaifa I/第一次： scrollX：: 0.0</span><br><span class="line">03-31 23:13:47.226 10457-10457/com.smart.kaifa I/第一次： scrollY：: 0.0</span><br><span class="line">03-31 23:13:48.228 10457-10457/com.smart.kaifa I/第二次： ********: ***************************************************************************</span><br><span class="line">03-31 23:13:48.228 10457-10457/com.smart.kaifa I/第二次： left：: 0</span><br><span class="line">03-31 23:13:48.228 10457-10457/com.smart.kaifa I/第二次： right：: 700</span><br><span class="line">03-31 23:13:48.228 10457-10457/com.smart.kaifa I/第二次： bottom：: 700</span><br><span class="line">03-31 23:13:48.228 10457-10457/com.smart.kaifa I/第二次： top：: 0</span><br><span class="line">03-31 23:13:48.228 10457-10457/com.smart.kaifa I/第二次： width：: 700</span><br><span class="line">03-31 23:13:48.229 10457-10457/com.smart.kaifa I/第二次： height：: 700</span><br><span class="line">03-31 23:13:48.229 10457-10457/com.smart.kaifa I/第二次： x：: 0.0</span><br><span class="line">03-31 23:13:48.229 10457-10457/com.smart.kaifa I/第二次： y：: 0.0</span><br><span class="line">03-31 23:13:48.229 10457-10457/com.smart.kaifa I/第二次： translationX：: 0.0</span><br><span class="line">03-31 23:13:48.229 10457-10457/com.smart.kaifa I/第二次： translationY：: 0.0</span><br><span class="line">03-31 23:13:48.229 10457-10457/com.smart.kaifa I/第二次： scrollX：: 0.0</span><br><span class="line">03-31 23:13:48.229 10457-10457/com.smart.kaifa I/第二次： scrollY：: 0.0</span><br></pre></td></tr></table></figure>
<p><img src="device-2018-03-31-232202.png" alt="Alt text" title="效果"><br>可以看到改变了宽和margin，layoutParams后面会探究的</p>
<h2 id="不同滑动方式的对比"><a href="#不同滑动方式的对比" class="headerlink" title="不同滑动方式的对比"></a>不同滑动方式的对比</h2><ul>
<li>scrollTo和scrollBy ：主要适合对View内容的滑动</li>
<li>动画：操作简单，主要适合没有交互的View和实现复杂动画效果</li>
<li>改变布局参数：操作稍微复杂，使用与有交互的View</li>
</ul>
<h1 id="弹性滑动"><a href="#弹性滑动" class="headerlink" title="弹性滑动"></a>弹性滑动</h1><p>知道了View的滑动，我们还要知道如何实现View的弹性滑动，实现弹性滑动的方式有很多，比如通过handler#postDelayed…</p>
<h2 id="Scroller-：之前说过"><a href="#Scroller-：之前说过" class="headerlink" title="Scroller ：之前说过"></a>Scroller ：之前说过</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">public class TestTouchView extends FrameLayout &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private Scroller scroller;</span><br><span class="line"></span><br><span class="line">    public TestTouchView(Context context) &#123;</span><br><span class="line">        super(context);</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public TestTouchView(Context context, AttributeSet attrs) &#123;</span><br><span class="line">        super(context, attrs);</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void init() &#123;</span><br><span class="line"></span><br><span class="line">        scroller = new Scroller(getContext());</span><br><span class="line"></span><br><span class="line">        smoothScrollTo(-1000, 100);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void smoothScrollTo(int x, int y) &#123;</span><br><span class="line">        int x1 = getScrollX();</span><br><span class="line">        int dx = x - x1;</span><br><span class="line">        Log.i(&quot;--------&quot;, &quot;smoothScrollTo&quot;);</span><br><span class="line">        scroller.startScroll(0, 0, dx, 0, 10000);</span><br><span class="line">        invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void computeScroll() &#123;</span><br><span class="line">        if (scroller.computeScrollOffset()) &#123;</span><br><span class="line">            Log.i(&quot;computeScroll CurrX:&quot;, &quot;&quot; + scroller.getCurrX());</span><br><span class="line">            scrollTo(scroller.getCurrX(), scroller.getCurrY());</span><br><span class="line">            postInvalidate();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意一下这里滑动是View的内容的滑动，不包括View本身，其实也是通过修改scrollX和scrollY来实现的<br>注意一下 这里说一下原理：<br>首先创建了一个Scroller，然后使用<code>scroller.startScroll(0, 0, dx, 0, 10000)</code>之后<code>invalidate()</code>这个时候会调用View的<code>onDraw</code>方法。然后<code>onDraw</code>方法有调用了View的<code>computeScroll</code>,就是我们重写的这个方法，这样就不断重新绘制，直到完成</p>
<h2 id="通过动画"><a href="#通过动画" class="headerlink" title="通过动画"></a>通过动画</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ObjectAnimator.ofFloat(viewById,&quot;translationX&quot;,0,100).setDuration(1000).start();</span><br></pre></td></tr></table></figure>
<p>这里也可以通过值动画（属性动画的一种）来玩成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    private View viewById;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        viewById = findViewById(R.id.test);</span><br><span class="line">        final int startx=0;</span><br><span class="line">        final int endx=100;</span><br><span class="line">        ValueAnimator animator = ValueAnimator.ofInt(0, 1).setDuration(1000);</span><br><span class="line">        animator.addUpdateListener(new ValueAnimator.AnimatorUpdateListener() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void onAnimationUpdate(ValueAnimator animation) &#123;</span><br><span class="line">                float animatedFraction = animation.getAnimatedFraction();</span><br><span class="line">                viewById.scrollTo((int) (startx+endx*animatedFraction),0);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        animator.start();</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public void onWindowFocusChanged(boolean hasFocus) &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>这个和Scroller一样</p>
<h2 id="也可以使用延时策略"><a href="#也可以使用延时策略" class="headerlink" title="也可以使用延时策略"></a>也可以使用延时策略</h2><p>如果使用handler，这个不一定流畅，因为调度handler是会有延时的</p>
<h1 id="View的事件分发机制"><a href="#View的事件分发机制" class="headerlink" title="View的事件分发机制"></a>View的事件分发机制</h1><p>上面介绍了View的基础知识和View的滑动，这里介绍一下View的事件分发机制</p>
<h2 id="点击事件的传递规则"><a href="#点击事件的传递规则" class="headerlink" title="点击事件的传递规则"></a>点击事件的传递规则</h2><p>这里分析的对象是MotionEvent。事件传递的过程其实就是MotionEvent的传递</p>
<p>三个传递的方法</p>
<ul>
<li>dispatchTouchEvent(MotionEvent event)<br>用来进行事件分发，如果事件能够传递到当前View，则这个方法一定会被调用，返回值结果手当前View的onTouchEvent和下级的dispatchTouchEvent方法影响，表示是否消耗当前事件</li>
<li>onInterceptTouchEvent(MotionEvent event)<br>在这个方法中是内部调用的方法，用来判断是否拦截某个事件，如果当前View拦截了某个事件，那么在同一个事件序列当中，此方法不会再被调用，返回结果表示是否拦截了当前的事件</li>
<li>onTouchEvent(MotionEvent event)</li>
</ul>
<p>在dispatchTouchEvent中调用，用来处理点击事件，返回结果表示是否消耗了当前事件，如果不消耗，则同一事件序列中，当前View无法再次接收到事件</p>
<p>这里用伪代码来描述一下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public boolean dispatchTouchEvent(MotionEvent ev)&#123;</span><br><span class="line">  boolean consume=false;</span><br><span class="line">  if(onInterceptTouchEvent(ev))&#123;</span><br><span class="line">    consume=onTouchEvent(ev);</span><br><span class="line"></span><br><span class="line">  &#125;else&#123;</span><br><span class="line">    consume=child.dispatchTouchTvent(ev);</span><br><span class="line">  &#125;</span><br><span class="line">  return consume;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>上面的伪代码已经将三者的关系表现的很清楚了。通过上面的伪代码，我们可以大致了解点击事件传递规则：对于一个根ViewGroup来说，点击事件产生后，首先会传递给它，这个时候会调用他的<code>dispatchTouchEvent</code>方法，如果他的<code>onInterceptTouchEvent</code>返回true，表示要拦截这个事件，这个时候事件就会交给这个控件<code>onTouchEvent</code>，如果这个ViewGroup的<code>onInterceptTouchEvent</code>方法返回false，表示不拦截，这个时候当前的事件就会传递给子控件，接着子控件的<code>dispatchTouchEvent</code>就会被调用。如此反复<br>当一个View需要处理事件的时候，如果他设置了<code>OnTouchListener</code>，那么<code>OnTouchListener</code>中的<code>OnTouch</code>方法就会被调用。这个时候事件的处理要看<code>OnTouch</code>的返回值，如果返回false,则当前的<code>OnTouch</code>方法就会被调用。如果返回true,则当前的<code>OnTouch</code>方法就不会被调用。因此，给View设置OnTouchListener，其优先级比OnTouchRvent要搞。在Ontouch方法中如果设置有OnClickListener,那么他的OnClick方法就会被调用，OnClickListener是优先级最低的。</p>
<p>当一个点击事件产生之后，他的传递过程遵循如下顺序：Activity-&gt;Window-&gt;View，即事件总是先传递给Activity，Activity传递给Window，最后Window在传递给顶级的View，然后在按照事件分发的及机制分发事件。考虑到一种情况，如果一个View的OnTouchEvent返回false，那么他的父容器的OnTouchEvent就会被调用，以此类推，如果所有的元素都不处理这个事件，那么这个事件将会最终传递给Activity处理。即Activity的OnTouchEvent 会被调用</p>
<p>一个事件传递的demo<br>布局<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;FrameLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    xmlns:tools=&quot;http://schemas.android.com/tools&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    tools:context=&quot;com.smart.kaifa.MainActivity&quot;&gt;</span><br><span class="line">    &lt;com.smart.kaifa.TestTouchView</span><br><span class="line">        android:id=&quot;@+id/test&quot;</span><br><span class="line">        android:layout_width=&quot;400dp&quot;</span><br><span class="line">        android:layout_height=&quot;400dp&quot;</span><br><span class="line">        android:background=&quot;#ff00ff&quot;&gt;</span><br><span class="line">        &lt;com.smart.kaifa.TestTouchView1</span><br><span class="line">            android:layout_width=&quot;300dp&quot;</span><br><span class="line">            android:layout_height=&quot;300dp&quot;</span><br><span class="line">            android:background=&quot;#00ffff&quot;&gt;</span><br><span class="line">            &lt;com.smart.kaifa.TestView</span><br><span class="line">                android:layout_width=&quot;50dp&quot;</span><br><span class="line">                android:layout_height=&quot;50dp&quot;</span><br><span class="line">                android:background=&quot;#00ff00&quot;</span><br><span class="line">                android:text=&quot;dkdk&quot; /&gt;</span><br><span class="line">            &lt;com.smart.kaifa.Test1View</span><br><span class="line">                android:layout_width=&quot;50dp&quot;</span><br><span class="line">                android:layout_height=&quot;50dp&quot;</span><br><span class="line">                android:layout_marginLeft=&quot;60dp&quot;</span><br><span class="line">                android:background=&quot;#0000ff&quot;</span><br><span class="line">                android:text=&quot;dkdk&quot; /&gt;</span><br><span class="line">        &lt;/com.smart.kaifa.TestTouchView1&gt;</span><br><span class="line">    &lt;/com.smart.kaifa.TestTouchView&gt;</span><br><span class="line">&lt;/FrameLayout&gt;</span><br></pre></td></tr></table></figure></p>
<p>Activity<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line"></span><br><span class="line">    private View viewById;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        viewById = findViewById(R.id.test);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onWindowFocusChanged(boolean hasFocus) &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean dispatchTouchEvent(MotionEvent ev) &#123;</span><br><span class="line">        Log.i(&quot;哇哈哈   MainActivity&quot;, &quot;dispatchTouchEvent========&quot;);</span><br><span class="line">        return super.dispatchTouchEvent(ev);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean onTouchEvent(MotionEvent event) &#123;</span><br><span class="line">        Log.i(&quot;哇哈哈   MainActivity&quot;, &quot;onTouchEvent========&quot;);</span><br><span class="line">        return super.onTouchEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>TestTouchView<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">public class TestTouchView extends FrameLayout &#123;</span><br><span class="line"></span><br><span class="line">    public TestTouchView(Context context) &#123;</span><br><span class="line">        super(context);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public TestTouchView(Context context, AttributeSet attrs) &#123;</span><br><span class="line">        super(context, attrs);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean dispatchTouchEvent(MotionEvent ev) &#123;</span><br><span class="line">        Log.i(&quot;哇哈哈   TestTouchView&quot;, &quot;dispatchTouchEvent========&quot;);</span><br><span class="line">        return super.dispatchTouchEvent(ev);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean onInterceptTouchEvent(MotionEvent ev) &#123;</span><br><span class="line">        Log.i(&quot;哇哈哈   TestTouchView&quot;, &quot;onInterceptTouchEvent========&quot;);</span><br><span class="line">        return super.onInterceptTouchEvent(ev);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean onTouchEvent(MotionEvent event) &#123;</span><br><span class="line">        Log.i(&quot;哇哈哈   TestTouchView&quot;, &quot;onTouchEvent========&quot;);</span><br><span class="line">        return super.onTouchEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>TestView<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">public class TestView extends View &#123;</span><br><span class="line"></span><br><span class="line">    public TestView(Context context) &#123;</span><br><span class="line">        super(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public TestView(Context context, @Nullable AttributeSet attrs) &#123;</span><br><span class="line">        super(context, attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public TestView(Context context, @Nullable AttributeSet attrs, int defStyleAttr) &#123;</span><br><span class="line">        super(context, attrs, defStyleAttr);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean dispatchTouchEvent(MotionEvent ev) &#123;</span><br><span class="line">        Log.i(&quot;哇哈哈   TestView&quot;,&quot;dispatchTouchEvent========&quot;);</span><br><span class="line">        return super.dispatchTouchEvent(ev);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean onTouchEvent(MotionEvent event) &#123;</span><br><span class="line">        Log.i(&quot;哇哈哈   TestView&quot;,&quot;onTouchEvent========&quot;);</span><br><span class="line">        return super.onTouchEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>activity和View 是没有<code>onInterceptTouchEvent</code></p>
<p>这里有一些注意点：</p>
<ol>
<li>同一个事件是从手指按下到离开，包含down 和若干个move最后是up</li>
<li>正常情况下，一个事件序列只能被一个View拦截且消耗，这一条原因可以参考下一条，因为一旦一个元素拦截了这个事件，那么同一个事件序列内的所有事件都会直接交给他处理。因此同一个事件序列的事件不能分别有两个View处理，但是通过特殊的手段可以做到，比如讲一个本该自己处理的事件传递给其他控件，在自己的<code>OnTouchEvent</code>方法中调用其他控件的<code>OnTouchEvent</code>方法</li>
<li>某个View一旦决定拦截，那么这一个事件序列都只能由他来处理（如果事件序列能够传递的话），并且它的<code>onInterceptTouchEvent</code>不会再被调用，这个也很好理解。就是说如果当一个View决定拦截一个事件之后，那么系统会把同一个事件徐磊内的其他方法都直接交给他处理。因此就不用再调用这个View的<code>OnInterceptTouchEvent</code>方法。<br>这里：在TestTouchView中拦截<code>onInterceptTouchEvent</code>返回true,但是没有在onTouchEvent中处理他,这个时候TestTouchView的子控件就收不到事件，并且由于事件没有处理，就会传递给activity，之后就不会再调用拦截的方法，直接交给处理的人，<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>这里：在TestTouchView1中拦截<code>onInterceptTouchEvent</code>返回true，并且在TestTouchView中处理事件，TestTouchView的<code>onTouchEvent</code>方法返回true,这个时候事件会分发，虽然是在TestTouchView1中拦截的，但是由于不是在TestTouchView1中处理，系统在第一次down的时候知道了事件是TestTouchView处理的，就不会再分发给TestTouchView1了<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView1: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br></pre></td></tr></table></figure></p>
<ol start="4">
<li><p>如果View不消耗除Action_Down以外的其他事件，那么这个点击事件就会消失。此时父元素的OnTouchEvent并不会被调用，并且当前View可以持续受到后续的事件，最终这些消失的点击事件会传递给Activity处理<br>默认都没有拦截事件，这个时候如果在View上面移动，可以看到只有down事件是全部传递了，move和up都没有经过子View，这个直接传递给了activity的onTouchEvent来处理</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView1: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   Test1View: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView1: onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br></pre></td></tr></table></figure>
</li>
<li><p>某个View一旦开始处理事件，如果它不消耗Action_Down事件，（<code>ontouchEvent</code>返回了false），那么，同一个事件序列中的其他事件都不会再交给他来处理，并且事件将重新交给他的父元素去处理，即父元素的<code>OnTouchEvent</code>方法会被调用。意思就是事件一旦交给一个View处理，那么他就必须消耗掉，否则同一事件序列中剩下的事件就不会再交给他来处理了。</p>
</li>
<li>ViewGroup默认不拦截任何事件。Android源码中ViewGroup的<code>onInterceptTouch-Event</code>方法默认返回false</li>
<li>View没有<code>onInterceptTouch-Event</code>方法，一旦有点击事件传递给他，那么他的OnTouchEvent方法就会被调用</li>
<li>View的<code>onTouchEvent</code>默认都会消耗事件，返回true，除非他是不可点击的（clickable和longClickable同时为false）。View的longClickable属性默认为false，clickable属性要分情况，比如Botton的clickable属性默认为true，而textview的clickable属性默认为false</li>
</ol>
<p>Test1View 是一个button<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView1: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   Test1View: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView1: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   Test1View: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView1: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   Test1View: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView1: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   Test1View: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br></pre></td></tr></table></figure></p>
<p>TestView 是一个textview<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView1: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestView: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView1: onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">    onTouchEvent========</span><br></pre></td></tr></table></figure></p>
<p>可以看到 bottom是有clickable的，所以默认onTouchEvent返回true，之后所有的事件都交给Test1View处理，而TestView是textview，不是clickable，，所以默认onTouchEvent返回false，之后所有的事件都交给activitty处理处理</p>
<ol start="9">
<li>View的enable属性不影响onTouchEvent的返回值。哪怕一个View是disable状态，只要他的clickable或者longClickable有一个为true，那么他的onTouchEvent就返回true</li>
<li>onclick会发生的前提是当前View是可以点击的，并且他收到了down和up事件</li>
<li>事件传递过程是由外向内的，即从父控件传递给子控件。通过<code>requestDisallowInterceptTouchEvent</code>方法可以在子元素中干预父元素的时间分发过程，但是ActionDown除外</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">public class TestTouchView1 extends FrameLayout &#123;</span><br><span class="line">    public TestTouchView1(@NonNull Context context) &#123;</span><br><span class="line">        super(context);</span><br><span class="line">    &#125;</span><br><span class="line">    public TestTouchView1(@NonNull Context context, @Nullable AttributeSet attrs) &#123;</span><br><span class="line">        super(context, attrs);</span><br><span class="line">    &#125;</span><br><span class="line">    public TestTouchView1(@NonNull Context context, @Nullable AttributeSet attrs, int defStyleAttr) &#123;</span><br><span class="line">        super(context, attrs, defStyleAttr);</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public boolean dispatchTouchEvent(MotionEvent ev) &#123;</span><br><span class="line">        Log.i(&quot;哇哈哈   TestTouchView1&quot;, &quot;dispatchTouchEvent========&quot;);</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public boolean onInterceptTouchEvent(MotionEvent ev) &#123;</span><br><span class="line">        Log.i(&quot;哇哈哈   TestTouchView1&quot;, &quot;onInterceptTouchEvent========&quot;);</span><br><span class="line">        switch (ev.getAction()) &#123;</span><br><span class="line">            case MotionEvent.ACTION_DOWN:  //这里不能拦截了，不然事件就不会传递给子控件。但是在子控件中</span><br><span class="line">                return false;</span><br><span class="line">            case MotionEvent.ACTION_MOVE:   //表示父类需要</span><br><span class="line">                return true;</span><br><span class="line">            case MotionEvent.ACTION_UP:</span><br><span class="line">                return true;</span><br><span class="line">            default:</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;    //如果设置拦截，除了down,其他都是父类处理</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public boolean onTouchEvent(MotionEvent event) &#123;</span><br><span class="line">        Log.i(&quot;哇哈哈   TestTouchView1&quot;, &quot;onTouchEvent========&quot;);</span><br><span class="line">        return super.onTouchEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">public class Test1View extends Button &#123;</span><br><span class="line"></span><br><span class="line">    public Test1View(Context context) &#123;</span><br><span class="line">        super(context);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public Test1View(Context context, @Nullable AttributeSet attrs) &#123;</span><br><span class="line">        super(context, attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Test1View(Context context, @Nullable AttributeSet attrs, int defStyleAttr) &#123;</span><br><span class="line">        super(context, attrs, defStyleAttr);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean dispatchTouchEvent(MotionEvent ev) &#123;</span><br><span class="line">//        getParent().requestDisallowInterceptTouchEvent(false);</span><br><span class="line"></span><br><span class="line">        Log.i(&quot;哇哈哈   Test1View&quot;,&quot;dispatchTouchEvent========&quot;);</span><br><span class="line">        return super.dispatchTouchEvent(ev);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean onTouchEvent(MotionEvent event) &#123;</span><br><span class="line">        Log.i(&quot;哇哈哈   Test1View&quot;,&quot;onTouchEvent========&quot;);</span><br><span class="line">        switch (event.getAction())&#123;</span><br><span class="line">            case MotionEvent.ACTION_DOWN:</span><br><span class="line">                getParent().requestDisallowInterceptTouchEvent(true);</span><br><span class="line">                Log.d(&quot;TAG&quot;, &quot;You down button&quot;);</span><br><span class="line">                break;</span><br><span class="line">            case MotionEvent.ACTION_UP:</span><br><span class="line">                Log.d(&quot;TAG&quot;, &quot;You up button&quot;);</span><br><span class="line">                break;</span><br><span class="line">            case MotionEvent.ACTION_MOVE:</span><br><span class="line">                Log.d(&quot;TAG&quot;, &quot;You move button&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">        return true;</span><br><span class="line">//        return super.onTouchEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到虽然父控件拦截了up和move事件，但是子控件使用了<code>getParent().requestDisallowInterceptTouchEvent</code>告诉父控件不要拦截，父控件就不会拦截<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView1: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView1: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: dispatchTouchEvent========</span><br><span class="line">    onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView1: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   MainActivity: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: dispatchTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView: onInterceptTouchEvent========</span><br><span class="line">com.smart.kaifa I/哇哈哈   TestTouchView1: dispatchTouchEvent========</span><br></pre></td></tr></table></figure></p>
<h2 id="事件分发源码分析：有四个组件"><a href="#事件分发源码分析：有四个组件" class="headerlink" title="事件分发源码分析：有四个组件"></a>事件分发源码分析：有四个组件</h2><ul>
<li>activity</li>
</ul>
<p>dispatchTouchEvent</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public boolean dispatchTouchEvent(MotionEvent ev) &#123;</span><br><span class="line"></span><br><span class="line">    //如果是down 调用空方法onUserInteraction()</span><br><span class="line">    // 然后将event传递给window</span><br><span class="line">    // 1</span><br><span class="line">     if (ev.getAction() == MotionEvent.ACTION_DOWN) &#123;</span><br><span class="line">         onUserInteraction();</span><br><span class="line">     &#125;</span><br><span class="line">     //getWindow() 得到phoneWindow</span><br><span class="line">     //2</span><br><span class="line">     if (getWindow().superDispatchTouchEvent(ev)) &#123;</span><br><span class="line">         return true;</span><br><span class="line">     &#125;</span><br><span class="line">     return onTouchEvent(ev);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line">public void onUserInteraction() &#123;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>onTouchEvent</p>
<ul>
<li>window</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//3</span><br><span class="line">@Override</span><br><span class="line">  public boolean superDispatchTouchEvent(MotionEvent event) &#123;</span><br><span class="line">      //这里将事件传递给 最顶层的ViewGroup</span><br><span class="line">      return mDecor.superDispatchTouchEvent(event);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>DecorView</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">//4  这个是最顶层的ViewGroup</span><br><span class="line">public boolean superDispatchTouchEvent(MotionEvent event) &#123;</span><br><span class="line">    return super.dispatchTouchEvent(event);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>viewgroup<br>//5</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">   public boolean dispatchTouchEvent(MotionEvent ev) &#123;</span><br><span class="line">           //InputFilter 的工作也分为两个步骤，首先由InputEventConsistencyVerifier 对象（InputEventConsistencyVerifier.java）对输入事件的完整性做一个检查，检查事件的ACTION_DOWN 和 ACTION_UP 是否一一配对</span><br><span class="line">       if (mInputEventConsistencyVerifier != null) &#123;</span><br><span class="line">           mInputEventConsistencyVerifier.onTouchEvent(ev, 1);</span><br><span class="line">       &#125;</span><br><span class="line">        // 判断是否要分发</span><br><span class="line">       // If the event targets the accessibility focused view and this is it, start</span><br><span class="line">       // normal event dispatch. Maybe a descendant is what will handle the click.</span><br><span class="line">       if (ev.isTargetAccessibilityFocus() &amp;&amp; isAccessibilityFocusedViewOrHost()) &#123;</span><br><span class="line">           ev.setTargetAccessibilityFocus(false);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       boolean handled = false;</span><br><span class="line">       //如果事件是一个安全的事件，就进入</span><br><span class="line">       if (onFilterTouchEventForSecurity(ev)) &#123;</span><br><span class="line">           final int action = ev.getAction();</span><br><span class="line">           final int actionMasked = action &amp; MotionEvent.ACTION_MASK;</span><br><span class="line"></span><br><span class="line">           // Handle an initial down.</span><br><span class="line">           // 如果是down事件</span><br><span class="line">           if (actionMasked == MotionEvent.ACTION_DOWN) &#123;</span><br><span class="line">               // Throw away all previous state when starting a new touch gesture.</span><br><span class="line">               // The framework may have dropped the up or cancel event for the previous gesture</span><br><span class="line">               // due to an app switch, ANR, or some other state change.</span><br><span class="line"></span><br><span class="line">               // Cancels and clears all touch targets.  清空之前对控件的操作</span><br><span class="line">               cancelAndClearTouchTargets(ev);</span><br><span class="line">               // 重置触摸状态</span><br><span class="line">               resetTouchState();</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           // Check for interception.</span><br><span class="line">           final boolean intercepted;</span><br><span class="line">           //如果是down事件  mFirstTouchTarget:如果事件由ViewGroup的子控件处理成功， mFirstTouchTarget 会被赋值，并指向子元素</span><br><span class="line">           //如果是down事件，就一定会走这个if判断</span><br><span class="line">           //如果不是down事件，并且不交给子控件处理，intercepted = true</span><br><span class="line">           if (actionMasked == MotionEvent.ACTION_DOWN</span><br><span class="line">                   || mFirstTouchTarget != null) &#123;</span><br><span class="line">                     //mGroupFlags :这个标记为是子控件调用requestDisallowInterceptTouchEvent的时候设定，用于子控件给父控件提示要不要拦截事件</span><br><span class="line">               final boolean disallowIntercept = (mGroupFlags &amp; FLAG_DISALLOW_INTERCEPT) != 0;</span><br><span class="line"></span><br><span class="line">               if (!disallowIntercept) &#123;</span><br><span class="line">                 //如果没有子控件的提示，调用父控件的拦截事件的方法</span><br><span class="line">                 //onInterceptTouchEvent 不是每次都调用的</span><br><span class="line">                   intercepted = onInterceptTouchEvent(ev);</span><br><span class="line">                   ev.setAction(action); // restore action in case it was changed</span><br><span class="line">               &#125; else &#123;</span><br><span class="line">                   intercepted = false;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125; else &#123;</span><br><span class="line">               // There are no touch targets and this action is not an initial down</span><br><span class="line">               // so this view group continues to intercept touches.</span><br><span class="line">               intercepted = true;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           // If intercepted, start normal event dispatch. Also if there is already</span><br><span class="line">           // a view that is handling the gesture, do normal event dispatch.</span><br><span class="line">           if (intercepted || mFirstTouchTarget != null) &#123;</span><br><span class="line">               ev.setTargetAccessibilityFocus(false);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           // Check for cancelation.</span><br><span class="line">           // 判断是否取消此次事件</span><br><span class="line">           final boolean canceled = resetCancelNextUpFlag(this)</span><br><span class="line">                   || actionMasked == MotionEvent.ACTION_CANCEL;</span><br><span class="line"></span><br><span class="line">           // Update list of touch targets for pointer down, if needed.</span><br><span class="line">           final boolean split = (mGroupFlags &amp; FLAG_SPLIT_MOTION_EVENTS) != 0;</span><br><span class="line">           TouchTarget newTouchTarget = null;</span><br><span class="line">           boolean alreadyDispatchedToNewTouchTarget = false;</span><br><span class="line">           // 如果事件不取消也不拦截</span><br><span class="line">           if (!canceled &amp;&amp; !intercepted) &#123;</span><br><span class="line"></span><br><span class="line">               // If the event is targeting accessiiblity focus we give it to the</span><br><span class="line">               // view that has accessibility focus and if it does not handle it</span><br><span class="line">               // we clear the flag and dispatch the event to all children as usual.</span><br><span class="line">               // We are looking up the accessibility focused host to avoid keeping</span><br><span class="line">               // state since these events are very rare.</span><br><span class="line">               View childWithAccessibilityFocus = ev.isTargetAccessibilityFocus()</span><br><span class="line">                       ? findChildWithAccessibilityFocus() : null;</span><br><span class="line"></span><br><span class="line">               if (actionMasked == MotionEvent.ACTION_DOWN</span><br><span class="line">                       || (split &amp;&amp; actionMasked == MotionEvent.ACTION_POINTER_DOWN)</span><br><span class="line">                       || actionMasked == MotionEvent.ACTION_HOVER_MOVE) &#123;</span><br><span class="line">                   final int actionIndex = ev.getActionIndex(); // always 0 for down</span><br><span class="line">                   final int idBitsToAssign = split ? 1 &lt;&lt; ev.getPointerId(actionIndex)</span><br><span class="line">                           : TouchTarget.ALL_POINTER_IDS;</span><br><span class="line"></span><br><span class="line">                   // Clean up earlier touch targets for this pointer id in case they</span><br><span class="line">                   // have become out of sync.</span><br><span class="line">                   removePointersFromTouchTargets(idBitsToAssign);</span><br><span class="line">                  // 获取子控件的数量</span><br><span class="line">                   final int childrenCount = mChildrenCount;</span><br><span class="line">                   if (newTouchTarget == null &amp;&amp; childrenCount != 0) &#123;</span><br><span class="line">                     // 获取event的x和y</span><br><span class="line">                       final float x = ev.getX(actionIndex);</span><br><span class="line">                       final float y = ev.getY(actionIndex);</span><br><span class="line">                       // Find a child that can receive the event.</span><br><span class="line">                       // Scan children from front to back.</span><br><span class="line">                       final ArrayList&lt;View&gt; preorderedList = buildTouchDispatchChildList();</span><br><span class="line">                       final boolean customOrder = preorderedList == null</span><br><span class="line">                               &amp;&amp; isChildrenDrawingOrderEnabled();</span><br><span class="line">                       final View[] children = mChildren;</span><br><span class="line">                       for (int i = childrenCount - 1; i &gt;= 0; i--) &#123;</span><br><span class="line">                         // 遍历子控件，</span><br><span class="line">                           final int childIndex = getAndVerifyPreorderedIndex(</span><br><span class="line">                                   childrenCount, i, customOrder);</span><br><span class="line">                           final View child = getAndVerifyPreorderedView(</span><br><span class="line">                                   preorderedList, children, childIndex);</span><br><span class="line"></span><br><span class="line">                           // If there is a view that has accessibility focus we want it</span><br><span class="line">                           // to get the event first and if not handled we will perform a</span><br><span class="line">                           // normal dispatch. We may do a double iteration but this is</span><br><span class="line">                           // safer given the timeframe.</span><br><span class="line">                           if (childWithAccessibilityFocus != null) &#123;</span><br><span class="line">                               if (childWithAccessibilityFocus != child) &#123;</span><br><span class="line">                                   continue;</span><br><span class="line">                               &#125;</span><br><span class="line">                               childWithAccessibilityFocus = null;</span><br><span class="line">                               i = childrenCount - 1;</span><br><span class="line">                           &#125;</span><br><span class="line">                          //判断子控件是否在进行动画播放，判断点击事件是否在一个子控件的范围里面isTransformedTouchPointInView</span><br><span class="line">                           if (!canViewReceivePointerEvents(child)</span><br><span class="line">                                   || !isTransformedTouchPointInView(x, y, child, null)) &#123;</span><br><span class="line">                               ev.setTargetAccessibilityFocus(false);</span><br><span class="line">                               continue;</span><br><span class="line">                           &#125;</span><br><span class="line">                          // 满足不在播放动画并且在控件内</span><br><span class="line">                           newTouchTarget = getTouchTarget(child);</span><br><span class="line">                           if (newTouchTarget != null) &#123;</span><br><span class="line">                               // Child is already receiving touch within its bounds.</span><br><span class="line">                               // Give it the new pointer in addition to the ones it is handling.</span><br><span class="line">                               newTouchTarget.pointerIdBits |= idBitsToAssign;</span><br><span class="line">                               break;</span><br><span class="line">                           &#125;</span><br><span class="line"></span><br><span class="line">                           resetCancelNextUpFlag(child);</span><br><span class="line">                           // 如果子控件不为空并且可以接受：</span><br><span class="line">                           //如果不能接受就交个父控件</span><br><span class="line">                           if (dispatchTransformedTouchEvent(ev, false, child, idBitsToAssign)) &#123;</span><br><span class="line">                               // Child wants to receive touch within its bounds.</span><br><span class="line">                               mLastTouchDownTime = ev.getDownTime();</span><br><span class="line">                               if (preorderedList != null) &#123;</span><br><span class="line">                                   // childIndex points into presorted list, find original index</span><br><span class="line">                                   for (int j = 0; j &lt; childrenCount; j++) &#123;</span><br><span class="line">                                       if (children[childIndex] == mChildren[j]) &#123;</span><br><span class="line">                                           mLastTouchDownIndex = j;</span><br><span class="line">                                           break;</span><br><span class="line">                                       &#125;</span><br><span class="line">                                   &#125;</span><br><span class="line">                               &#125; else &#123;</span><br><span class="line">                                   mLastTouchDownIndex = childIndex;</span><br><span class="line">                               &#125;</span><br><span class="line">                               mLastTouchDownX = ev.getX();</span><br><span class="line">                               mLastTouchDownY = ev.getY();</span><br><span class="line">                               // 处理TouchTarget。这个可以理解为一个链式结构，用于处理事件的拦截</span><br><span class="line">                               //这里 mFirstTouchTarget就赋值，不为空</span><br><span class="line">                               newTouchTarget = addTouchTarget(child, idBitsToAssign);</span><br><span class="line">                               alreadyDispatchedToNewTouchTarget = true;</span><br><span class="line">                               break;</span><br><span class="line">                           &#125;</span><br><span class="line"></span><br><span class="line">                           // The accessibility focus didn&apos;t handle the event, so clear</span><br><span class="line">                           // the flag and do a normal dispatch to all children.</span><br><span class="line">                           ev.setTargetAccessibilityFocus(false);</span><br><span class="line">                       &#125;</span><br><span class="line">                       if (preorderedList != null) preorderedList.clear();</span><br><span class="line">                   &#125;</span><br><span class="line"></span><br><span class="line">                   if (newTouchTarget == null &amp;&amp; mFirstTouchTarget != null) &#123;</span><br><span class="line">                       // Did not find a child to receive the event.</span><br><span class="line">                       // Assign the pointer to the least recently added target.</span><br><span class="line">                       newTouchTarget = mFirstTouchTarget;</span><br><span class="line">                       while (newTouchTarget.next != null) &#123;</span><br><span class="line">                           newTouchTarget = newTouchTarget.next;</span><br><span class="line">                       &#125;</span><br><span class="line">                       newTouchTarget.pointerIdBits |= idBitsToAssign;</span><br><span class="line">                   &#125;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           // Dispatch to touch targets.</span><br><span class="line">           if (mFirstTouchTarget == null) &#123;</span><br><span class="line">               // No touch targets so treat this as an ordinary view.</span><br><span class="line">               handled = dispatchTransformedTouchEvent(ev, canceled, null,</span><br><span class="line">                       TouchTarget.ALL_POINTER_IDS);</span><br><span class="line">           &#125; else &#123;</span><br><span class="line">               // Dispatch to touch targets, excluding the new touch target if we already</span><br><span class="line">               // dispatched to it.  Cancel touch targets if necessary.</span><br><span class="line">               TouchTarget predecessor = null;</span><br><span class="line">               TouchTarget target = mFirstTouchTarget;</span><br><span class="line">               while (target != null) &#123;</span><br><span class="line">                   final TouchTarget next = target.next;</span><br><span class="line">                   if (alreadyDispatchedToNewTouchTarget &amp;&amp; target == newTouchTarget) &#123;</span><br><span class="line">                       handled = true;</span><br><span class="line">                   &#125; else &#123;</span><br><span class="line">                       final boolean cancelChild = resetCancelNextUpFlag(target.child)</span><br><span class="line">                               || intercepted;</span><br><span class="line">                       if (dispatchTransformedTouchEvent(ev, cancelChild,</span><br><span class="line">                               target.child, target.pointerIdBits)) &#123;</span><br><span class="line">                           handled = true;</span><br><span class="line">                       &#125;</span><br><span class="line">                       if (cancelChild) &#123;</span><br><span class="line">                           if (predecessor == null) &#123;</span><br><span class="line">                               mFirstTouchTarget = next;</span><br><span class="line">                           &#125; else &#123;</span><br><span class="line">                               predecessor.next = next;</span><br><span class="line">                           &#125;</span><br><span class="line">                           target.recycle();</span><br><span class="line">                           target = next;</span><br><span class="line">                           continue;</span><br><span class="line">                       &#125;</span><br><span class="line">                   &#125;</span><br><span class="line">                   predecessor = target;</span><br><span class="line">                   target = next;</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           // Update list of touch targets for pointer up or cancel, if needed.</span><br><span class="line">           if (canceled</span><br><span class="line">                   || actionMasked == MotionEvent.ACTION_UP</span><br><span class="line">                   || actionMasked == MotionEvent.ACTION_HOVER_MOVE) &#123;</span><br><span class="line">               resetTouchState();</span><br><span class="line">           &#125; else if (split &amp;&amp; actionMasked == MotionEvent.ACTION_POINTER_UP) &#123;</span><br><span class="line">               final int actionIndex = ev.getActionIndex();</span><br><span class="line">               final int idBitsToRemove = 1 &lt;&lt; ev.getPointerId(actionIndex);</span><br><span class="line">               removePointersFromTouchTargets(idBitsToRemove);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       if (!handled &amp;&amp; mInputEventConsistencyVerifier != null) &#123;</span><br><span class="line">           mInputEventConsistencyVerifier.onUnhandledEvent(ev, 1);</span><br><span class="line">       &#125;</span><br><span class="line">       return handled;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   @Override</span><br><span class="line">       public void requestDisallowInterceptTouchEvent(boolean disallowIntercept) &#123;</span><br><span class="line"></span><br><span class="line">           if (disallowIntercept == ((mGroupFlags &amp; FLAG_DISALLOW_INTERCEPT) != 0)) &#123;</span><br><span class="line">               // We&apos;re already in this state, assume our ancestors are too</span><br><span class="line">               return;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           if (disallowIntercept) &#123;</span><br><span class="line">               mGroupFlags |= FLAG_DISALLOW_INTERCEPT;</span><br><span class="line">           &#125; else &#123;</span><br><span class="line">               mGroupFlags &amp;= ~FLAG_DISALLOW_INTERCEPT;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           // Pass it up to our parent</span><br><span class="line">           if (mParent != null) &#123;</span><br><span class="line">               mParent.requestDisallowInterceptTouchEvent(disallowIntercept);</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      // 判断事件分发给谁</span><br><span class="line">      6</span><br><span class="line">       private boolean dispatchTransformedTouchEvent(MotionEvent event, boolean cancel,</span><br><span class="line">               View child, int desiredPointerIdBits) &#123;</span><br><span class="line">           final boolean handled;</span><br><span class="line"></span><br><span class="line">           // Canceling motions is a special case.  We don&apos;t need to perform any transformations</span><br><span class="line">           // or filtering.  The important part is the action, not the contents.</span><br><span class="line">           final int oldAction = event.getAction();</span><br><span class="line">           if (cancel || oldAction == MotionEvent.ACTION_CANCEL) &#123;</span><br><span class="line">               event.setAction(MotionEvent.ACTION_CANCEL);</span><br><span class="line">               if (child == null) &#123;</span><br><span class="line">                   handled = super.dispatchTouchEvent(event);</span><br><span class="line">               &#125; else &#123;</span><br><span class="line">                   handled = child.dispatchTouchEvent(event);</span><br><span class="line">               &#125;</span><br><span class="line">               event.setAction(oldAction);</span><br><span class="line">               return handled;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           // Calculate the number of pointers to deliver.</span><br><span class="line">           final int oldPointerIdBits = event.getPointerIdBits();</span><br><span class="line">           final int newPointerIdBits = oldPointerIdBits &amp; desiredPointerIdBits;</span><br><span class="line"></span><br><span class="line">           // If for some reason we ended up in an inconsistent state where it looks like we</span><br><span class="line">           // might produce a motion event with no pointers in it, then drop the event.</span><br><span class="line">           if (newPointerIdBits == 0) &#123;</span><br><span class="line">               return false;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           // If the number of pointers is the same and we don&apos;t need to perform any fancy</span><br><span class="line">           // irreversible transformations, then we can reuse the motion event for this</span><br><span class="line">           // dispatch as long as we are careful to revert any changes we make.</span><br><span class="line">           // Otherwise we need to make a copy.</span><br><span class="line">           final MotionEvent transformedEvent;</span><br><span class="line">           if (newPointerIdBits == oldPointerIdBits) &#123;</span><br><span class="line">               if (child == null || child.hasIdentityMatrix()) &#123;</span><br><span class="line">                   if (child == null) &#123;</span><br><span class="line">                       handled = super.dispatchTouchEvent(event);</span><br><span class="line">                   &#125; else &#123;</span><br><span class="line">                       final float offsetX = mScrollX - child.mLeft;</span><br><span class="line">                       final float offsetY = mScrollY - child.mTop;</span><br><span class="line">                       event.offsetLocation(offsetX, offsetY);</span><br><span class="line"></span><br><span class="line">                       handled = child.dispatchTouchEvent(event);</span><br><span class="line"></span><br><span class="line">                       event.offsetLocation(-offsetX, -offsetY);</span><br><span class="line">                   &#125;</span><br><span class="line">                   return handled;</span><br><span class="line">               &#125;</span><br><span class="line">               transformedEvent = MotionEvent.obtain(event);</span><br><span class="line">           &#125; else &#123;</span><br><span class="line">               transformedEvent = event.split(newPointerIdBits);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           // Perform any necessary transformations and dispatch.</span><br><span class="line">           if (child == null) &#123;</span><br><span class="line">               handled = super.dispatchTouchEvent(transformedEvent);</span><br><span class="line">           &#125; else &#123;</span><br><span class="line">               final float offsetX = mScrollX - child.mLeft;</span><br><span class="line">               final float offsetY = mScrollY - child.mTop;</span><br><span class="line">               transformedEvent.offsetLocation(offsetX, offsetY);</span><br><span class="line">               if (! child.hasIdentityMatrix()) &#123;</span><br><span class="line">                   transformedEvent.transform(child.getInverseMatrix());</span><br><span class="line">               &#125;</span><br><span class="line"></span><br><span class="line">               handled = child.dispatchTouchEvent(transformedEvent);</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           // Done.</span><br><span class="line">           transformedEvent.recycle();</span><br><span class="line">           return handled;</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>view</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br></pre></td><td class="code"><pre><span class="line">// 7</span><br><span class="line">public boolean dispatchTouchEvent(MotionEvent event) &#123;</span><br><span class="line">       // If the event should be handled by accessibility focus first.</span><br><span class="line">       if (event.isTargetAccessibilityFocus()) &#123;</span><br><span class="line">           // We don&apos;t have focus or no virtual descendant has it, do not handle the event.</span><br><span class="line">           if (!isAccessibilityFocusedViewOrHost()) &#123;</span><br><span class="line">               return false;</span><br><span class="line">           &#125;</span><br><span class="line">           // We have focus and got the event, then use normal event dispatch.</span><br><span class="line">           event.setTargetAccessibilityFocus(false);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       boolean result = false;</span><br><span class="line"></span><br><span class="line">       if (mInputEventConsistencyVerifier != null) &#123;</span><br><span class="line">           mInputEventConsistencyVerifier.onTouchEvent(event, 0);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       final int actionMasked = event.getActionMasked();</span><br><span class="line">       if (actionMasked == MotionEvent.ACTION_DOWN) &#123;</span><br><span class="line">           // Defensive cleanup for new gesture</span><br><span class="line">           stopNestedScroll();</span><br><span class="line">       &#125;</span><br><span class="line">      // 对事件进行过滤</span><br><span class="line">       if (onFilterTouchEventForSecurity(event)) &#123;</span><br><span class="line">           if ((mViewFlags &amp; ENABLED_MASK) == ENABLED &amp;&amp; handleScrollBarDragging(event)) &#123;</span><br><span class="line">               result = true;</span><br><span class="line">           &#125;</span><br><span class="line">           //noinspection SimplifiableIfStatement</span><br><span class="line">           ListenerInfo li = mListenerInfo;</span><br><span class="line">           //判断有没有TouchListener，这个在onTouchEvent之前处理</span><br><span class="line">           if (li != null &amp;&amp; li.mOnTouchListener != null</span><br><span class="line">                   &amp;&amp; (mViewFlags &amp; ENABLED_MASK) == ENABLED</span><br><span class="line">                   &amp;&amp; li.mOnTouchListener.onTouch(this, event)) &#123;</span><br><span class="line">               result = true;</span><br><span class="line">           &#125;</span><br><span class="line">           // 如果没有拦截，调用View 的onTouchEvent</span><br><span class="line">           if (!result &amp;&amp; onTouchEvent(event)) &#123;</span><br><span class="line">               result = true;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       if (!result &amp;&amp; mInputEventConsistencyVerifier != null) &#123;</span><br><span class="line">           mInputEventConsistencyVerifier.onUnhandledEvent(event, 0);</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       // Clean up after nested scrolls if this is the end of a gesture;</span><br><span class="line">       // also cancel it if we tried an ACTION_DOWN but we didn&apos;t want the rest</span><br><span class="line">       // of the gesture.</span><br><span class="line">       if (actionMasked == MotionEvent.ACTION_UP ||</span><br><span class="line">               actionMasked == MotionEvent.ACTION_CANCEL ||</span><br><span class="line">               (actionMasked == MotionEvent.ACTION_DOWN &amp;&amp; !result)) &#123;</span><br><span class="line">           stopNestedScroll();</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       return result;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">   //8  如果没有onTouchListener 就调用onTouchEvent</span><br><span class="line">   public boolean onTouchEvent(MotionEvent event) &#123;</span><br><span class="line">       final float x = event.getX();</span><br><span class="line">       final float y = event.getY();</span><br><span class="line">       final int viewFlags = mViewFlags;</span><br><span class="line">       final int action = event.getAction();</span><br><span class="line"></span><br><span class="line">       final boolean clickable = ((viewFlags &amp; CLICKABLE) == CLICKABLE</span><br><span class="line">               || (viewFlags &amp; LONG_CLICKABLE) == LONG_CLICKABLE)</span><br><span class="line">               || (viewFlags &amp; CONTEXT_CLICKABLE) == CONTEXT_CLICKABLE;</span><br><span class="line"></span><br><span class="line">       if ((viewFlags &amp; ENABLED_MASK) == DISABLED) &#123;</span><br><span class="line">           if (action == MotionEvent.ACTION_UP &amp;&amp; (mPrivateFlags &amp; PFLAG_PRESSED) != 0) &#123;</span><br><span class="line">               setPressed(false);</span><br><span class="line">           &#125;</span><br><span class="line">           mPrivateFlags3 &amp;= ~PFLAG3_FINGER_DOWN;</span><br><span class="line">           // 在不可以用状态下的View也会消耗事件</span><br><span class="line">           // A disabled view that is clickable still consumes the touch</span><br><span class="line">           // events, it just doesn&apos;t respond to them.</span><br><span class="line">           return clickable;</span><br><span class="line">       &#125;</span><br><span class="line">       // 如果View设置代理，就会调用这个方法</span><br><span class="line">       if (mTouchDelegate != null) &#123;</span><br><span class="line">           if (mTouchDelegate.onTouchEvent(event)) &#123;</span><br><span class="line">               return true;</span><br><span class="line">           &#125;</span><br><span class="line">       &#125;</span><br><span class="line">      //对点击事件的处理</span><br><span class="line">      // 知道可以点击或者长按就会消耗事件</span><br><span class="line">      // 那么就会返回true，表示处理了这个事件</span><br><span class="line">       if (clickable || (viewFlags &amp; TOOLTIP) == TOOLTIP) &#123;</span><br><span class="line">           switch (action) &#123;</span><br><span class="line">               case MotionEvent.ACTION_UP:</span><br><span class="line">                   mPrivateFlags3 &amp;= ~PFLAG3_FINGER_DOWN;</span><br><span class="line">                   if ((viewFlags &amp; TOOLTIP) == TOOLTIP) &#123;</span><br><span class="line">                       handleTooltipUp();</span><br><span class="line">                   &#125;</span><br><span class="line">                   if (!clickable) &#123;</span><br><span class="line">                       removeTapCallback();</span><br><span class="line">                       removeLongPressCallback();</span><br><span class="line">                       mInContextButtonPress = false;</span><br><span class="line">                       mHasPerformedLongPress = false;</span><br><span class="line">                       mIgnoreNextUpEvent = false;</span><br><span class="line">                       break;</span><br><span class="line">                   &#125;</span><br><span class="line">                   boolean prepressed = (mPrivateFlags &amp; PFLAG_PREPRESSED) != 0;</span><br><span class="line">                   if ((mPrivateFlags &amp; PFLAG_PRESSED) != 0 || prepressed) &#123;</span><br><span class="line">                       // take focus if we don&apos;t have it already and we should in</span><br><span class="line">                       // touch mode.</span><br><span class="line">                       boolean focusTaken = false;</span><br><span class="line">                       if (isFocusable() &amp;&amp; isFocusableInTouchMode() &amp;&amp; !isFocused()) &#123;</span><br><span class="line">                           focusTaken = requestFocus();</span><br><span class="line">                       &#125;</span><br><span class="line"></span><br><span class="line">                       if (prepressed) &#123;</span><br><span class="line">                           // The button is being released before we actually</span><br><span class="line">                           // showed it as pressed.  Make it show the pressed</span><br><span class="line">                           // state now (before scheduling the click) to ensure</span><br><span class="line">                           // the user sees it.</span><br><span class="line">                           setPressed(true, x, y);</span><br><span class="line">                       &#125;</span><br><span class="line"></span><br><span class="line">                       if (!mHasPerformedLongPress &amp;&amp; !mIgnoreNextUpEvent) &#123;</span><br><span class="line">                           // This is a tap, so remove the longpress check</span><br><span class="line">                           removeLongPressCallback();</span><br><span class="line"></span><br><span class="line">                           // Only perform take click actions if we were in the pressed state</span><br><span class="line">                           if (!focusTaken) &#123;</span><br><span class="line">                               // Use a Runnable and post this rather than calling</span><br><span class="line">                               // performClick directly. This lets other visual state</span><br><span class="line">                               // of the view update before click actions start.</span><br><span class="line">                               // 如果设置了onClickListener，就会在这里处理  performClick()处理点击事件，就是说在up的时候处理的</span><br><span class="line">                               if (mPerformClick == null) &#123;</span><br><span class="line">                                   mPerformClick = new PerformClick();</span><br><span class="line">                               &#125;</span><br><span class="line">                               if (!post(mPerformClick)) &#123;</span><br><span class="line">                                   performClick();</span><br><span class="line">                               &#125;</span><br><span class="line">                           &#125;</span><br><span class="line">                       &#125;</span><br><span class="line"></span><br><span class="line">                       if (mUnsetPressedState == null) &#123;</span><br><span class="line">                           mUnsetPressedState = new UnsetPressedState();</span><br><span class="line">                       &#125;</span><br><span class="line"></span><br><span class="line">                       if (prepressed) &#123;</span><br><span class="line">                           postDelayed(mUnsetPressedState,</span><br><span class="line">                                   ViewConfiguration.getPressedStateDuration());</span><br><span class="line">                       &#125; else if (!post(mUnsetPressedState)) &#123;</span><br><span class="line">                           // If the post failed, unpress right now</span><br><span class="line">                           mUnsetPressedState.run();</span><br><span class="line">                       &#125;</span><br><span class="line"></span><br><span class="line">                       removeTapCallback();</span><br><span class="line">                   &#125;</span><br><span class="line">                   mIgnoreNextUpEvent = false;</span><br><span class="line">                   break;</span><br><span class="line"></span><br><span class="line">               case MotionEvent.ACTION_DOWN:</span><br><span class="line">                   if (event.getSource() == InputDevice.SOURCE_TOUCHSCREEN) &#123;</span><br><span class="line">                       mPrivateFlags3 |= PFLAG3_FINGER_DOWN;</span><br><span class="line">                   &#125;</span><br><span class="line">                   mHasPerformedLongPress = false;</span><br><span class="line"></span><br><span class="line">                   if (!clickable) &#123;</span><br><span class="line">                       checkForLongClick(0, x, y);</span><br><span class="line">                       break;</span><br><span class="line">                   &#125;</span><br><span class="line"></span><br><span class="line">                   if (performButtonActionOnTouchDown(event)) &#123;</span><br><span class="line">                       break;</span><br><span class="line">                   &#125;</span><br><span class="line"></span><br><span class="line">                   // Walk up the hierarchy to determine if we&apos;re inside a scrolling container.</span><br><span class="line">                   boolean isInScrollingContainer = isInScrollingContainer();</span><br><span class="line"></span><br><span class="line">                   // For views inside a scrolling container, delay the pressed feedback for</span><br><span class="line">                   // a short period in case this is a scroll.</span><br><span class="line">                   if (isInScrollingContainer) &#123;</span><br><span class="line">                       mPrivateFlags |= PFLAG_PREPRESSED;</span><br><span class="line">                       if (mPendingCheckForTap == null) &#123;</span><br><span class="line">                           mPendingCheckForTap = new CheckForTap();</span><br><span class="line">                       &#125;</span><br><span class="line">                       mPendingCheckForTap.x = event.getX();</span><br><span class="line">                       mPendingCheckForTap.y = event.getY();</span><br><span class="line">                       postDelayed(mPendingCheckForTap, ViewConfiguration.getTapTimeout());</span><br><span class="line">                   &#125; else &#123;</span><br><span class="line">                       // Not inside a scrolling container, so show the feedback right away</span><br><span class="line">                       setPressed(true, x, y);</span><br><span class="line">                       checkForLongClick(0, x, y);</span><br><span class="line">                   &#125;</span><br><span class="line">                   break;</span><br><span class="line"></span><br><span class="line">               case MotionEvent.ACTION_CANCEL:</span><br><span class="line">                   if (clickable) &#123;</span><br><span class="line">                       setPressed(false);</span><br><span class="line">                   &#125;</span><br><span class="line">                   removeTapCallback();</span><br><span class="line">                   removeLongPressCallback();</span><br><span class="line">                   mInContextButtonPress = false;</span><br><span class="line">                   mHasPerformedLongPress = false;</span><br><span class="line">                   mIgnoreNextUpEvent = false;</span><br><span class="line">                   mPrivateFlags3 &amp;= ~PFLAG3_FINGER_DOWN;</span><br><span class="line">                   break;</span><br><span class="line"></span><br><span class="line">               case MotionEvent.ACTION_MOVE:</span><br><span class="line">                   if (clickable) &#123;</span><br><span class="line">                       drawableHotspotChanged(x, y);</span><br><span class="line">                   &#125;</span><br><span class="line"></span><br><span class="line">                   // Be lenient about moving outside of buttons</span><br><span class="line">                   if (!pointInView(x, y, mTouchSlop)) &#123;</span><br><span class="line">                       // Outside button</span><br><span class="line">                       // Remove any future long press/tap checks</span><br><span class="line">                       removeTapCallback();</span><br><span class="line">                       removeLongPressCallback();</span><br><span class="line">                       if ((mPrivateFlags &amp; PFLAG_PRESSED) != 0) &#123;</span><br><span class="line">                           setPressed(false);</span><br><span class="line">                       &#125;</span><br><span class="line">                       mPrivateFlags3 &amp;= ~PFLAG3_FINGER_DOWN;</span><br><span class="line">                   &#125;</span><br><span class="line">                   break;</span><br><span class="line">           &#125;</span><br><span class="line"></span><br><span class="line">           return true;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">       return false;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">// 9 这个方法如果设置了点击事件，可以看到会设置标记</span><br><span class="line">   public void setOnClickListener(@Nullable OnClickListener l) &#123;</span><br><span class="line">       if (!isClickable()) &#123;</span><br><span class="line">           setClickable(true);</span><br><span class="line">       &#125;</span><br><span class="line">       getListenerInfo().mOnClickListener = l;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">st=&gt;start: start</span><br><span class="line">op1=&gt;operation: activity dispatchTouchEvent</span><br><span class="line">op2=&gt;operation: window.superDispatchTouchEvent</span><br><span class="line">op3=&gt;operation: mDecor.superDispatchTouchEvent</span><br><span class="line">op4=&gt;operation: viewgroup.dispatchTouchEvent</span><br><span class="line">op5=&gt;operation: viewgroup.requestDisallowInterceptTouchEvent</span><br><span class="line">op6=&gt;operation: viewgroup.onInterceptTouchEvent</span><br><span class="line">op7=&gt;operation: viewgroup.dispatchTransformedTouchEvent</span><br><span class="line">op8=&gt;operation: view.dispatchTouchEvent</span><br><span class="line">op10=&gt;operation: view.onTouchEvent</span><br><span class="line">op12=&gt;operation: viewgroup.onTouchEvent</span><br><span class="line">op13=&gt;operation: activity.onTouchEvent</span><br><span class="line">cond1=&gt;condition: 子控件是否设置了requestDisallowInterceptTouchEvent</span><br><span class="line">cond2=&gt;condition: viewgroup是否拦截事件onInterceptTouchEvent</span><br><span class="line">cond3=&gt;condition: 处理事件：是自己处理还是交给子控件处理</span><br><span class="line">cond4=&gt;condition: 子控件是否设置了TouchListener</span><br><span class="line">cond5=&gt;condition: 子控件是否设置了ClickListener</span><br><span class="line">e=&gt;end</span><br><span class="line">st-&gt;op1-&gt;op2-&gt;op3-&gt;op4-&gt;op5-&gt;cond1</span><br><span class="line">cond1(yes)-&gt;op6-&gt;cond2</span><br><span class="line">cond1(no)-&gt;cond2</span><br><span class="line">cond2(yes)-&gt;op12-&gt;op13</span><br><span class="line">cond2(no)-&gt;op7-&gt;op</span><br><span class="line">cond3(yes)-&gt;op12-&gt;cond5</span><br><span class="line">cond3(no)-&gt;op8-&gt;cond4</span><br><span class="line">cond4(yes)-&gt;e</span><br><span class="line">cond4(no)-&gt;op10-&gt;cond5</span><br><span class="line">cond5(yes)-&gt;e</span><br><span class="line">cond5(no)-&gt;op12-&gt;op13-&gt;e</span><br></pre></td></tr></table></figure>
<h1 id="View的滑动冲突"><a href="#View的滑动冲突" class="headerlink" title="View的滑动冲突"></a>View的滑动冲突</h1><p>这个是开发的时候经常遇到的问题</p>
<h2 id="常见的滑动冲突场景"><a href="#常见的滑动冲突场景" class="headerlink" title="常见的滑动冲突场景"></a>常见的滑动冲突场景</h2><ul>
<li>场景1 : 外部滑动方向和内部滑动方向不一致</li>
<li>场景2 ：外部华东方向和内部滑动方向一致</li>
<li>场景3 ：上面两种嵌套的情况</li>
</ul>
<p>这里先说场景1 ： 这个主要是Viewpager和Fragment配合的时候所组成的页面滑动，主流应用几乎都会使用这个效果。在fragment中有listview。Viewpager内部帮助我们处理了这种冲突，但是如果是scrollView就会遇到冲突。<br>再说一下场景2 ： 这种情况就稍微复杂一点，因为是内部和外部同时都会监听同一个方向的滚动，所以系统不知道要将事件分发给谁。一般是内部滑动，外部跟着滑动<br>最后说一下场景3 ：场景1和场景2两种情况嵌套，因此这个比较复杂。</p>
<h2 id="事件冲突的处理规则"><a href="#事件冲突的处理规则" class="headerlink" title="事件冲突的处理规则"></a>事件冲突的处理规则</h2><p>不管冲突多么复杂，总归是有规则的。<br>第一种情况可以根据三角形来计算，如果是水平方向的dx大于垂直方向的dy，就用dx，反之一样<br>第二种情况要依据具体的情况来解答<br>第三种情况更加复杂，后面举个例子</p>
<h2 id="滑动冲突的解决方式"><a href="#滑动冲突的解决方式" class="headerlink" title="滑动冲突的解决方式"></a>滑动冲突的解决方式</h2><ol>
<li>外部拦截法<br>所谓的外部拦截法法，就是点击事件都会先经过父控件处理，然后进行分发，如果不需要，就拦截。需要重写<code>onInterceptTouchEvent</code></li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">   public boolean onInterceptTouchEvent(MotionEvent ev) &#123;</span><br><span class="line">       boolean intercepted = false;</span><br><span class="line">       boolean need = false;// 父控件是否需要点击事件</span><br><span class="line">       int x = (int) ev.getX();</span><br><span class="line">       int y = (int) ev.getY();</span><br><span class="line">       switch (ev.getAction()) &#123;</span><br><span class="line">           case MotionEvent.ACTION_DOWN:</span><br><span class="line">               intercepted=false;</span><br><span class="line">         break;</span><br><span class="line">           case MotionEvent.ACTION_MOVE:</span><br><span class="line">               if(need)&#123;</span><br><span class="line">                   intercepted=true;</span><br><span class="line">               &#125;else&#123;</span><br><span class="line">                   intercepted=false;</span><br><span class="line">               &#125;</span><br><span class="line">                   break;</span><br><span class="line">           case MotionEvent.ACTION_UP:</span><br><span class="line">               intercepted=false;</span><br><span class="line">               break;</span><br><span class="line">           default:</span><br><span class="line">               break;</span><br><span class="line">       &#125;</span><br><span class="line">       return intercepted;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>这个就是一个典型的外部拦截法的处理，针对不同的冲突，只需要适当修改拦截的条件就可以。首先down必须返回false，不然所有事件就会被父控件拦截。move事件更具具体情况进行拦截。up一定要返回false，因为单纯up事件是没有意义的。<br>考虑到一种情况：如果父控件在up时返回true，那么导致子控件无法接受到up事件，就无法触发子控件的onclick事件了。但是父控件这个比较特殊，一旦他开始拦截任何一个事件，那么后续的事件都会交给他来处理。而up作为最后一个事件也必定可以传递给父控件，即便父容器onInterceptTouchEvent在up是返回false</p>
<ol start="2">
<li>内部拦截发<br>这种方式是父控件不拦截事件，所有事件全部传递给子控件，子控件来处理。这种复方石和android事件分发机制不一致。需要配合requestDisallowInterceptTouchEvent来实现</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public boolean dispatchTouchEvent(MotionEvent ev) &#123;</span><br><span class="line"></span><br><span class="line">    int x = (int) ev.getX();</span><br><span class="line">    int y = (int) ev.getY();</span><br><span class="line"></span><br><span class="line">    switch (ev.getAction()) &#123;</span><br><span class="line">        case MotionEvent.ACTION_DOWN:</span><br><span class="line">         getParent().requestDisallowInterceptTouchEvent(true);</span><br><span class="line">            break;</span><br><span class="line">        case MotionEvent.ACTION_MOVE:</span><br><span class="line">          if(父控件需要)&#123;</span><br><span class="line">              getParent().requestDisallowInterceptTouchEvent(false);</span><br><span class="line">          &#125;</span><br><span class="line">            break;</span><br><span class="line">        case MotionEvent.ACTION_UP:</span><br><span class="line"></span><br><span class="line">            break;</span><br><span class="line">        default:</span><br><span class="line">            break;</span><br><span class="line">    &#125;</span><br><span class="line">    return super.dispatchTouchEvent(ev);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>实战<br>实战：父控件拦截法<br>下面通过一个demo来运用这两种方法<br>如果一个控件实现ViewGroup，一定要实现onLayout方法</li>
</ol>
<p>这个是activity<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line">        initView();</span><br><span class="line">    &#125;</span><br><span class="line">    private void initView() &#123;</span><br><span class="line">        LayoutInflater inflater = getLayoutInflater();</span><br><span class="line">        HorizontalScrollViewEx horizontalScrollView = findViewById(R.id.hsv);</span><br><span class="line">        int screenWidth = 1440;</span><br><span class="line">        int screenHeight = 1800;</span><br><span class="line">        // 添加View</span><br><span class="line">        for (int i = 0; i &lt; 3; i++) &#123;</span><br><span class="line">            ViewGroup layout = (ViewGroup) inflater.inflate(R.layout.test, horizontalScrollView, false);</span><br><span class="line">            layout.getLayoutParams().width = screenWidth;</span><br><span class="line">            TextView textView = layout.findViewById(R.id.title);</span><br><span class="line">            textView.setText(&quot;page i&quot; + 1);</span><br><span class="line">            layout.setBackgroundColor(Color.rgb(255 / (i + 1), 255 / (i + 1), 0));</span><br><span class="line">            createList(layout);</span><br><span class="line">            horizontalScrollView.addView(layout);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    private void createList(ViewGroup layout) &#123;</span><br><span class="line">        ListView listView = layout.findViewById(R.id.list);</span><br><span class="line">        ArrayList&lt;String&gt; datas = new ArrayList&lt;&gt;();</span><br><span class="line">        for (int i = 0; i &lt; 50; i++) &#123;</span><br><span class="line">            datas.add(&quot;name&quot; + i);</span><br><span class="line">        &#125;</span><br><span class="line">        ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(this, R.layout.content_list_item, R.id.name, datas);</span><br><span class="line">        listView.setAdapter(adapter);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void onWindowFocusChanged(boolean hasFocus) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br></pre></td><td class="code"><pre><span class="line">public class HorizontalScrollViewEx extends FrameLayout &#123;</span><br><span class="line">    private static final String TAG = &quot;HorizontalScrollViewEx&quot;;</span><br><span class="line">    private int mChildrenSize=3;</span><br><span class="line">    private int mCHildWidth=1440;</span><br><span class="line">    private int mChildIndex;</span><br><span class="line">    private int mLastX = 0;</span><br><span class="line">    private int mLastY = 0;</span><br><span class="line">    private int mLastXIntercept = 0;</span><br><span class="line">    private int mLastYIntercept = 0;</span><br><span class="line"></span><br><span class="line">    private Scroller mScroller;</span><br><span class="line">    private VelocityTracker mVelpcityTracker;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    private void init() &#123;</span><br><span class="line">        mScroller = new Scroller(getContext());</span><br><span class="line">        mVelpcityTracker = VelocityTracker.obtain();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public HorizontalScrollViewEx(Context context) &#123;</span><br><span class="line">        super(context);</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public HorizontalScrollViewEx(Context context, AttributeSet attrs) &#123;</span><br><span class="line">        super(context, attrs);</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public HorizontalScrollViewEx(Context context, AttributeSet attrs, int defStyleAttr) &#123;</span><br><span class="line">        super(context, attrs, defStyleAttr);</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // 判断是否拦截</span><br><span class="line">    @Override</span><br><span class="line">    public boolean onInterceptTouchEvent(MotionEvent event) &#123;</span><br><span class="line">        boolean intercepted = false;</span><br><span class="line">        int x = (int) event.getX();</span><br><span class="line">        int y = (int) event.getY();</span><br><span class="line"></span><br><span class="line">        switch (event.getAction()) &#123;</span><br><span class="line">            case MotionEvent.ACTION_DOWN:</span><br><span class="line">                intercepted = false;</span><br><span class="line">                if (!mScroller.isFinished()) &#123;</span><br><span class="line">                    //动画没有结束强制结束动画</span><br><span class="line">                    mScroller.abortAnimation();</span><br><span class="line">                    intercepted = true;</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case MotionEvent.ACTION_MOVE:</span><br><span class="line"></span><br><span class="line">                int deltaX = x - mLastXIntercept;</span><br><span class="line">                int deltaY = x - mLastYIntercept;</span><br><span class="line">                if (Math.abs(deltaX) &gt; Math.abs(deltaY)) &#123;</span><br><span class="line">                    intercepted = true;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    intercepted = false;</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case MotionEvent.ACTION_UP:</span><br><span class="line">                intercepted = false;</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        Log.i(&quot;哇哈哈&quot;, &quot;intercepted :&quot; + intercepted);</span><br><span class="line">        mLastX = x;</span><br><span class="line">        mLastY = y;</span><br><span class="line">        mLastXIntercept = x;</span><br><span class="line">        mLastYIntercept = y;</span><br><span class="line">        return intercepted;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onLayout(boolean changed, int l, int t, int r, int b) &#123;</span><br><span class="line">        int childLeft = 0;</span><br><span class="line">        final int childCount = getChildCount();</span><br><span class="line">        mChildrenSize = childCount;</span><br><span class="line"></span><br><span class="line">        for (int i = 0; i &lt; childCount; i++) &#123;</span><br><span class="line">            final View childView = getChildAt(i);</span><br><span class="line">            if (childView.getVisibility() != View.GONE) &#123;</span><br><span class="line">                final int childWidth = childView.getMeasuredWidth();</span><br><span class="line">                childView.layout(childLeft, 0, childLeft + childWidth,</span><br><span class="line">                        childView.getMeasuredHeight());</span><br><span class="line">                childLeft += childWidth;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean onTouchEvent(MotionEvent event) &#123;</span><br><span class="line">        mVelpcityTracker.addMovement(event);</span><br><span class="line">        int x = (int) event.getX();</span><br><span class="line">        int y = (int) event.getY();</span><br><span class="line"></span><br><span class="line">        switch (event.getAction()) &#123;</span><br><span class="line">            case MotionEvent.ACTION_DOWN:</span><br><span class="line">                if (!mScroller.isFinished()) &#123;</span><br><span class="line">                    //动画没有结束强制结束动画</span><br><span class="line">                    mScroller.abortAnimation();</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case MotionEvent.ACTION_MOVE:</span><br><span class="line"></span><br><span class="line">                int deltaX = x - mLastX;</span><br><span class="line">                int deltaY = x - mLastY;</span><br><span class="line">                scrollBy(-deltaX, 0);</span><br><span class="line"></span><br><span class="line">                break;</span><br><span class="line">            case MotionEvent.ACTION_UP:</span><br><span class="line">                int scrollX = getScrollX();</span><br><span class="line">                int scrollToChildIndex = scrollX / mCHildWidth;</span><br><span class="line">                mVelpcityTracker.computeCurrentVelocity(1000);</span><br><span class="line">                float xVelocity = mVelpcityTracker.getXVelocity();</span><br><span class="line">                if (Math.abs(xVelocity) &gt;= 50) &#123;</span><br><span class="line">                    mChildIndex = xVelocity &gt; 0 ? mChildIndex - 1 : mChildIndex + 1;</span><br><span class="line"></span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    mChildIndex = (scrollX + mCHildWidth / 2) / mCHildWidth;</span><br><span class="line">                &#125;</span><br><span class="line">                mChildIndex = Math.max(0, Math.min(mChildIndex, mChildrenSize - 1));</span><br><span class="line">                int dx = mChildIndex * mCHildWidth - scrollX;</span><br><span class="line">                smoothScrollBy(dx, 0);</span><br><span class="line">                mVelpcityTracker.clear();</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        mLastY = y;</span><br><span class="line">        mLastX = x;</span><br><span class="line">        return super.onTouchEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void smoothScrollBy(int dx, int i) &#123;</span><br><span class="line">        mScroller.startScroll(getScrollX(), 0, dx, 0, 500);</span><br><span class="line">        invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void computeScroll() &#123;</span><br><span class="line">        if (mScroller.computeScrollOffset()) &#123;</span><br><span class="line">            scrollTo(mScroller.getCurrX(), mScroller.getCurrY());</span><br><span class="line">            postInvalidate();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        super.computeScroll();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;FrameLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    xmlns:tools=&quot;http://schemas.android.com/tools&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    tools:context=&quot;com.smart.kaifa.MainActivity&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;com.smart.kaifa.HorizontalScrollViewEx</span><br><span class="line">    android:id=&quot;@+id/hsv&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line">&lt;/com.smart.kaifa.HorizontalScrollViewEx&gt;</span><br><span class="line">&lt;/FrameLayout&gt;</span><br></pre></td></tr></table></figure></p>
<p>实战：子控件拦截法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public class ListViewEx extends ListView &#123;</span><br><span class="line">    private static final String TAG = &quot;ListEx&quot;;</span><br><span class="line">    private HorizontalScrollViewEx2 horizontalScrollViewEx2;</span><br><span class="line">    private int mLastX = 0;</span><br><span class="line">    private int mLastY = 0;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean dispatchTouchEvent(MotionEvent event) &#123;</span><br><span class="line">        horizontalScrollViewEx2= (HorizontalScrollViewEx2)( getParent());</span><br><span class="line">        int x = (int) event.getX();</span><br><span class="line">        int y = (int) event.getY();</span><br><span class="line">        switch (event.getAction()) &#123;</span><br><span class="line">            case MotionEvent.ACTION_DOWN:</span><br><span class="line">                // 父控件不要拦截</span><br><span class="line">                horizontalScrollViewEx2.requestDisallowInterceptTouchEvent(true);</span><br><span class="line">                break;</span><br><span class="line">            case MotionEvent.ACTION_MOVE:</span><br><span class="line"></span><br><span class="line">                int deltaX = x - mLastX;</span><br><span class="line">                int deltaY = x - mLastY;</span><br><span class="line">                if (Math.abs(deltaX) &gt; Math.abs(deltaY)) &#123;</span><br><span class="line">                    horizontalScrollViewEx2.requestDisallowInterceptTouchEvent(false);</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case MotionEvent.ACTION_UP:</span><br><span class="line"></span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line">        mLastX = x;</span><br><span class="line">        mLastY = y;</span><br><span class="line">        return super.dispatchTouchEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    public ListViewEx(Context context) &#123;</span><br><span class="line">        super(context);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public ListViewEx(Context context, AttributeSet attrs) &#123;</span><br><span class="line">        super(context, attrs);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public ListViewEx(Context context, AttributeSet attrs, int defStyleAttr) &#123;</span><br><span class="line">        super(context, attrs, defStyleAttr);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br></pre></td><td class="code"><pre><span class="line">public class HorizontalScrollViewEx2 extends ViewGroup &#123;</span><br><span class="line">    private int mChildrenSize = 3;</span><br><span class="line"></span><br><span class="line">    public HorizontalScrollViewEx2(Context context) &#123;</span><br><span class="line">        super(context);</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public HorizontalScrollViewEx2(Context context, AttributeSet attrs) &#123;</span><br><span class="line">        super(context, attrs);</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void init() &#123;</span><br><span class="line">        mScroller = new Scroller(getContext());</span><br><span class="line">        mVelpcityTracker = VelocityTracker.obtain();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public HorizontalScrollViewEx2(Context context, AttributeSet attrs, int defStyleAttr) &#123;</span><br><span class="line">        super(context, attrs, defStyleAttr);</span><br><span class="line">        init();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private Scroller mScroller;</span><br><span class="line">    private int mLastX = 0;</span><br><span class="line">    private int mLastY = 0;</span><br><span class="line">    private VelocityTracker mVelpcityTracker;</span><br><span class="line">    private int mCHildWidth = 1440;</span><br><span class="line">    private int mChildIndex;</span><br><span class="line">    private int mLastXIntercept = 0;</span><br><span class="line">    private int mLastYIntercept = 0;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onLayout(boolean changed, int l, int t, int r, int b) &#123;</span><br><span class="line">        int childLeft = 0;</span><br><span class="line">        final int childCount = getChildCount();</span><br><span class="line">        mChildrenSize = childCount;</span><br><span class="line">        for (int i = 0; i &lt; childCount; i++) &#123;</span><br><span class="line">            final View childView = getChildAt(i);</span><br><span class="line">//            if (childView.getVisibility() != View.GONE) &#123;</span><br><span class="line">                final int childWidth = childView.getMeasuredWidth();</span><br><span class="line">                childView.layout(childLeft, 0, childLeft + childWidth,</span><br><span class="line">                       1000);</span><br><span class="line">                childLeft += childWidth;</span><br><span class="line">//            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected void onMeasure(int widthMeasureSpec, int heightMeasureSpec) &#123;</span><br><span class="line">        super.onMeasure(widthMeasureSpec, heightMeasureSpec);</span><br><span class="line">        int measuredWidth = 0;</span><br><span class="line">        int measuredHeight = 0;</span><br><span class="line">        final int childCount = getChildCount();</span><br><span class="line">        measureChildren(widthMeasureSpec, heightMeasureSpec);</span><br><span class="line"></span><br><span class="line">        int widthSpaceSize = MeasureSpec.getSize(widthMeasureSpec);</span><br><span class="line">        int widthSpecMode = MeasureSpec.getMode(widthMeasureSpec);</span><br><span class="line">        int heightSpaceSize = MeasureSpec.getSize(heightMeasureSpec);</span><br><span class="line">        int heightSpecMode = MeasureSpec.getMode(heightMeasureSpec);</span><br><span class="line">        if (childCount == 0) &#123;</span><br><span class="line">            setMeasuredDimension(0, 0);</span><br><span class="line">        &#125; else if (heightSpecMode == MeasureSpec.AT_MOST) &#123;</span><br><span class="line">            final View childView = getChildAt(0);</span><br><span class="line">            measuredHeight = childView.getMeasuredHeight();</span><br><span class="line">            setMeasuredDimension(widthSpaceSize, childView.getMeasuredHeight());</span><br><span class="line">        &#125; else if (widthSpecMode == MeasureSpec.AT_MOST) &#123;</span><br><span class="line">            final View childView = getChildAt(0);</span><br><span class="line">            measuredWidth = childView.getMeasuredWidth() * childCount;</span><br><span class="line">            setMeasuredDimension(measuredWidth, heightSpaceSize);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            final View childView = getChildAt(0);</span><br><span class="line">            measuredWidth = childView.getMeasuredWidth() * childCount;</span><br><span class="line">            measuredHeight = childView.getMeasuredHeight();</span><br><span class="line">            setMeasuredDimension(measuredWidth, measuredHeight);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    private void smoothScrollBy(int dx, int i) &#123;</span><br><span class="line">        mScroller.startScroll(getScrollX(), 0, dx, 0, 500);</span><br><span class="line">        invalidate();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean onTouchEvent(MotionEvent event) &#123;</span><br><span class="line">        mVelpcityTracker.addMovement(event);</span><br><span class="line">        int x = (int) event.getX();</span><br><span class="line">        int y = (int) event.getY();</span><br><span class="line"></span><br><span class="line">        switch (event.getAction()) &#123;</span><br><span class="line">            case MotionEvent.ACTION_DOWN:</span><br><span class="line">                if (!mScroller.isFinished()) &#123;</span><br><span class="line">                    //动画没有结束强制结束动画</span><br><span class="line">                    mScroller.abortAnimation();</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case MotionEvent.ACTION_MOVE:</span><br><span class="line"></span><br><span class="line">                int deltaX = x - mLastX;</span><br><span class="line">                int deltaY = x - mLastY;</span><br><span class="line">                scrollBy(-deltaX, 0);</span><br><span class="line"></span><br><span class="line">                break;</span><br><span class="line">            case MotionEvent.ACTION_UP:</span><br><span class="line">                int scrollX = getScrollX();</span><br><span class="line">                int scrollToChildIndex = scrollX / mCHildWidth;</span><br><span class="line">                mVelpcityTracker.computeCurrentVelocity(1000);</span><br><span class="line">                float xVelocity = mVelpcityTracker.getXVelocity();</span><br><span class="line">                if (Math.abs(xVelocity) &gt;= 50) &#123;</span><br><span class="line">                    mChildIndex = xVelocity &gt; 0 ? mChildIndex - 1 : mChildIndex + 1;</span><br><span class="line"></span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    mChildIndex = (scrollX + mCHildWidth / 2) / mCHildWidth;</span><br><span class="line">                &#125;</span><br><span class="line">                mChildIndex = Math.max(0, Math.min(mChildIndex, mChildrenSize - 1));</span><br><span class="line">                int dx = mChildIndex * mCHildWidth - scrollX;</span><br><span class="line">                smoothScrollBy(dx, 0);</span><br><span class="line">                mVelpcityTracker.clear();</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        mLastY = y;</span><br><span class="line">        mLastX = x;</span><br><span class="line">        return super.onTouchEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void computeScroll() &#123;</span><br><span class="line">        if (mScroller.computeScrollOffset()) &#123;</span><br><span class="line">            scrollTo(mScroller.getCurrX(), mScroller.getCurrY());</span><br><span class="line">            postInvalidate();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        super.computeScroll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public boolean onInterceptTouchEvent(MotionEvent event) &#123;</span><br><span class="line">        int x = (int) event.getX();</span><br><span class="line">        int y = (int) event.getY();</span><br><span class="line"></span><br><span class="line">        switch (event.getAction()) &#123;</span><br><span class="line">            case MotionEvent.ACTION_DOWN:</span><br><span class="line">                mLastX = x;</span><br><span class="line">                mLastY = y;</span><br><span class="line"></span><br><span class="line">                if (!mScroller.isFinished()) &#123;</span><br><span class="line">                    //动画没有结束强制结束动画</span><br><span class="line">                    mScroller.abortAnimation();</span><br><span class="line">                    return true;</span><br><span class="line">                &#125;</span><br><span class="line">                return false;</span><br><span class="line">        &#125;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">public class MainActivity extends AppCompatActivity &#123;</span><br><span class="line">    @Override</span><br><span class="line">    protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">        super.onCreate(savedInstanceState);</span><br><span class="line">        setContentView(R.layout.activity_main);</span><br><span class="line"></span><br><span class="line">        initView();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void initView() &#123;</span><br><span class="line"></span><br><span class="line">        LayoutInflater inflater = getLayoutInflater();</span><br><span class="line">        HorizontalScrollViewEx2 horizontalScrollView = findViewById(R.id.hsv);</span><br><span class="line">        int screenWidth = 1440;</span><br><span class="line">        int screenHeight = 1800;</span><br><span class="line">        for (int i = 0; i &lt; 3; i++) &#123;</span><br><span class="line">            ViewGroup layout = (ViewGroup) inflater.inflate(R.layout.test, horizontalScrollView, false);</span><br><span class="line">            layout.getLayoutParams().width = screenWidth;</span><br><span class="line">            layout.getLayoutParams().height = screenHeight;</span><br><span class="line">            layout.setBackgroundColor(Color.rgb(255 / (i + 1), 255 / (i + 1), 0));</span><br><span class="line">            createList(layout);</span><br><span class="line">            horizontalScrollView.addView(layout);</span><br><span class="line">            Log.i(&quot;test11221&quot;, horizontalScrollView.getMeasuredWidth() + &quot;---&quot;);</span><br><span class="line">            layout.getWidth();</span><br><span class="line">            Log.i(&quot;test&quot;, layout.getMeasuredWidth() + &quot;&quot;);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void createList(ViewGroup layout) &#123;</span><br><span class="line">        ListViewEx listView = layout.findViewById(R.id.list);</span><br><span class="line">        ArrayList&lt;String&gt; datas = new ArrayList&lt;&gt;();</span><br><span class="line">        for (int i = 0; i &lt; 50; i++) &#123;</span><br><span class="line">            datas.add(&quot;name&quot; + i);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ArrayAdapter&lt;String&gt; adapter = new ArrayAdapter&lt;String&gt;(this, R.layout.content_list_item, R.id.name, datas);</span><br><span class="line">        listView.setAdapter(adapter);</span><br><span class="line">    &#125;</span><br><span class="line">    @Override</span><br><span class="line">    public void onWindowFocusChanged(boolean hasFocus) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;FrameLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    xmlns:app=&quot;http://schemas.android.com/apk/res-auto&quot;</span><br><span class="line">    xmlns:tools=&quot;http://schemas.android.com/tools&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;</span><br><span class="line">    tools:context=&quot;com.smart.kaifa.MainActivity&quot;&gt;</span><br><span class="line"></span><br><span class="line">&lt;com.smart.kaifa.HorizontalScrollViewEx2</span><br><span class="line">    android:id=&quot;@+id/hsv&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;match_parent&quot;&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/com.smart.kaifa.HorizontalScrollViewEx2&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/FrameLayout&gt;</span><br></pre></td></tr></table></figure>
<p>text.xml<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">    &lt;com.smart.kaifa.ListViewEx</span><br><span class="line">        android:id=&quot;@+id/list&quot;</span><br><span class="line">        xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;match_parent&quot;&gt;&lt;/com.smart.kaifa.ListViewEx&gt;</span><br></pre></td></tr></table></figure></p>
<p>注意一下，viewgroup很多时候要自己measure</p>
<p>这里提供一个场景来分析一下场景2</p>
<p>这里提供一个可以上下滑动父容器：StickyLayout，然后在他的内部分别放置一个Header和ListView这样内外两层就可以同时上下滑动。于是形成了场景2的冲突。当然这里的滑动规则是：当Header显示时或者ListView滑动到顶部的时候，由StickyLayout拦截事件，当header隐藏的时候，这里要分情况，如果是向下滑动，还是由StickyLayout拦截事件，如果向上滑动，就交给子控件。</p>
<p>这个在下一章View的工作原理里面介绍</p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/进阶/" rel="tag"># 进阶</a>
          
            <a href="/tags/Android开发艺术探索/" rel="tag"># Android开发艺术探索</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/android/Android开发艺术探索_第二章 IPC机制/" rel="next" title="Android开发艺术探索 第二章 IPC机制">
                <i class="fa fa-chevron-left"></i> Android开发艺术探索 第二章 IPC机制
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/android/Android开发艺术探索_第四章 View的工作原理/" rel="prev" title="Android开发艺术探索 第四章 View的工作原理">
                Android开发艺术探索 第四章 View的工作原理 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Groot</p>
              <p class="site-description motion-element" itemprop="description">尽信书则不如无书</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">53</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">3</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">21</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#View基础知识"><span class="nav-number">1.</span> <span class="nav-text">View基础知识</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是View？"><span class="nav-number">1.1.</span> <span class="nav-text">什么是View？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#View的位置？"><span class="nav-number">1.2.</span> <span class="nav-text">View的位置？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Motion和TouchSlop"><span class="nav-number">1.3.</span> <span class="nav-text">Motion和TouchSlop</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#VelocityTracker-GrstureDetrctor和Scroller"><span class="nav-number">1.4.</span> <span class="nav-text">VelocityTracker GrstureDetrctor和Scroller</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Scroller"><span class="nav-number">1.5.</span> <span class="nav-text">Scroller</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第一种：使用View本身提供的scrollTo和scrollBy实现滑动"><span class="nav-number">1.6.</span> <span class="nav-text">第一种：使用View本身提供的scrollTo和scrollBy实现滑动</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#第二种：属性动画，属性动画是改变View的属性值"><span class="nav-number">1.7.</span> <span class="nav-text">第二种：属性动画，属性动画是改变View的属性值</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使用布局参数，就是修改LayoutParams"><span class="nav-number">1.8.</span> <span class="nav-text">使用布局参数，就是修改LayoutParams</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#不同滑动方式的对比"><span class="nav-number">1.9.</span> <span class="nav-text">不同滑动方式的对比</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#弹性滑动"><span class="nav-number">2.</span> <span class="nav-text">弹性滑动</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Scroller-：之前说过"><span class="nav-number">2.1.</span> <span class="nav-text">Scroller ：之前说过</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#通过动画"><span class="nav-number">2.2.</span> <span class="nav-text">通过动画</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#也可以使用延时策略"><span class="nav-number">2.3.</span> <span class="nav-text">也可以使用延时策略</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#View的事件分发机制"><span class="nav-number">3.</span> <span class="nav-text">View的事件分发机制</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#点击事件的传递规则"><span class="nav-number">3.1.</span> <span class="nav-text">点击事件的传递规则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#事件分发源码分析：有四个组件"><span class="nav-number">3.2.</span> <span class="nav-text">事件分发源码分析：有四个组件</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#View的滑动冲突"><span class="nav-number">4.</span> <span class="nav-text">View的滑动冲突</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#常见的滑动冲突场景"><span class="nav-number">4.1.</span> <span class="nav-text">常见的滑动冲突场景</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#事件冲突的处理规则"><span class="nav-number">4.2.</span> <span class="nav-text">事件冲突的处理规则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#滑动冲突的解决方式"><span class="nav-number">4.3.</span> <span class="nav-text">滑动冲突的解决方式</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Groot</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
